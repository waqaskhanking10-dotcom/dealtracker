'use strict';mix_d("CustomerReviewsMediaCards__cr-media-carousel:cr-media-carousel___iFm6V2T","exports tslib @c/remote-operations @c/browser-operations @c/aui-feature-detect @c/scoped-dom @c/metrics @c/navigation @c/dom @c/logger @p/A".split(" "),function(Ab,g,ua,cc,dc,ec,Bb,fc,oa,T,gc){function va(a){return a&&"object"===typeof a&&"default"in a?a:{"default":a}}function Cb(a,b,c){return"https://"+Ca()+"/portal/customer-reviews/media-gallery/ref="+a+"?ie=UTF8&asin="+c+"&mediaType="+b}function Ca(){var a=
Z["default"].getLocation&&Z["default"].getLocation().hostname||location.href,b=Z["default"].getLocation&&Z["default"].getLocation().host||location.host;return"localhost"===a?"pre-prod.amazon.com":b}function Ya(a){return a?a===H.IMAGE?ha.IMAGE:ha.VIDEO:ha.MIXED}function hc(a){return Object.keys(a).map(function(b){return b+"="+a[b]}).join("&")}function ic(a,b){return g.__awaiter(this,void 0,void 0,function(){var c,d,e;return g.__generator(this,function(f){c=b.mediaType;d=b.metricsPrefix;G.logCounter(d+
"IvxClicked",1);e=Date.now();a.navigate({url:Db(b,!1),successCallback:function(){var h=Date.now()-e;G.logCounter(d+"IvxNavigatedDuration",h);G.logCounter(d+"IvxNavigated",1);G.logNoError("loadIVXError",c)},failCallback:function(h){G.logCounter(d+"IvxNavigated",0);Za("Failed to load SSNAP immersive modal for media: "+JSON.stringify(b)+".",h);G.logError("loadIVXError",c)}});return[2]})})}function jc(a,b){return g.__awaiter(this,void 0,void 0,function(){var c,d,e;return g.__generator(this,function(f){c=
b.mediaType;d=b.metricsPrefix;G.logCounter(d+"AnpClicked",1);e=Date.now();a.navigate({url:Db(b,!0),successCallback:function(){var h=Date.now()-e;G.logCounter(d+"AnpNavigatedDuration",h);G.logCounter(d+"AnpNavigated",1);G.logNoError("loadANPError",c)},failCallback:function(h){G.logCounter(d+"AnpNavigated",0);Za("Failed to load SSNAP ANP modal: "+JSON.stringify(b)+".",h);G.logError("loadANPError",c)}});return[2]})})}function Db(a,b){var c=b?"ssnap://www.amazon.com/anp/modal":"ssnap://www.amazon.com/ive";
if(b)b=g.__assign({mediaId:a.reviewId,asin:a.asin,mediaUrl:a.url,mediaType:a.mediaType===H.VIDEO?"video":"image"},a.thumbnailUrl&&{slateImageUrl:a.thumbnailUrl}),a={placementId:"customer-reviews-modal",ref:a.refMarker,ingressMediaItem:encodeURIComponent(JSON.stringify(b))};else{var d=b=g.__assign,e=g.__assign,f=a.hidePivot,h=a.ingressType,k=a.isSingleReview,m=a.asin,r=a.refMarker,n=a.metricsPrefix,w=a.reviewId,l=JSON,q=l.stringify;var p=a.mediaType===H.VIDEO;p=g.__assign({imageUrl:p?a.thumbnailUrl:
a.url,physicalId:a.physicalId},p&&{videoUrl:a.url});a=b.call(g,d.call(g,e.call(g,{hidePivot:f,ingressType:h,isSingleReview:k,productAsin:m,refMarker:r,metricsPrefix:n,reviewId:w,viewData:q.call(l,[p])},a.filter&&{filter:a.filter}),a.sessionId&&""!==a.sessionId&&{sessionId:a.sessionId}),a.mediaType===H.VIDEO?{videoUrl:a.url}:{imageUrl:a.url})}return c+"?"+hc(a)}var ia=va(ua),J=va(cc),Eb=va(dc),S=va(ec),Z=va(fc),Q=va(oa),Da=va(gc),pa;(function(a){a.IMAGE="IMAGE";a.VIDEO="VIDEO"})(pa||(pa={}));var La;
(function(a){a.helpfulVoteClickHandler="HelpfulVoteClickHandler";a.reportAbuseClickHandler="ReportAbuseClickHandler"})(La||(La={}));var Ma;(function(a){a.requestTranslationClickHandler="requestTranslationClickHandler";a.seeOriginalReviewClickHandler="seeOriginalReviewClickHandler"})(Ma||(Ma={}));var Fb;(function(a){a.translateAllReviewsClickHandler="TranslateAllReviewsClickHandler";a.showOriginalReviewsClickHandler="ShowOriginalReviewsClickHandler"})(Fb||(Fb={}));var Na;(function(a){a.imageClickHandler=
"SingleReviewMediaImageThumbnailClickHandler";a.videoClickHandler="SingleReviewMediaVideoThumbnailClickHandler"})(Na||(Na={}));var Oa;(function(a){a.popoverCloseButtonClickHandler="ReviewMediaPopoverCloseButtonClickHandler";a.popoverNextMediaClickHandler="ReviewMediaPopoverNextMediaClickHandler"})(Oa||(Oa={}));var Pa;(function(a){a.VOTE="vote";a.INLINE="inline_review";a.REPORT="report";a.SHOW_ALL="show_all_top"})(Pa||(Pa={}));var Qa;(function(a){a.SINGLE_REVIEW_PAGE="srp";a.DETAIL_PAGE="dp";a.ALL_REVIEWS_PAGE=
"arp"})(Qa||(Qa={}));var Ra;(function(a){a.EDIT="edit";a.DELETE="del";a.IMAGE="img";a.VIDEO="vid";a.TITLE="rvw_ttl"})(Ra||(Ra={}));var Sa;(function(a){a.DESKTOP="d";a.MOBILE_APP="ma";a.MOBILE_BROWSER="mb";a.TABLET_APP="ta";a.TABLET_BROWSER="tb";a.UNKNOWN="unkn"})(Sa||(Sa={}));var Gb=function(a){return"cm_cr_"+a.page+"_"+a.device+(a.widget?"_"+a.widget:"")+(a.location?"_"+a.location:"")},qa=function(a,b,c){Bb.count(c?c+"."+a:a,b)},lc=function(a,b){return g.__awaiter(void 0,void 0,void 0,function(){var c;
return g.__generator(this,function(d){c=Date.now();a.navigate({failCallback:function(e){var f="Failed to load IVX for reviewId: "+b.reviewId+".";e=e?f+". Error object: "+JSON.stringify({message:e.message,name:e.name,stack:e.stack}):f;T.log(e,"FATAL");qa("IvxMashNavigateError",1,b.mediaType)},successCallback:function(){var e=Date.now()-c;qa("IvxMashNavigateLatency",e,b.mediaType);qa("IvxMashNavigateError",0,b.mediaType);qa("IvxMashNavigate",1,b.mediaType)},url:kc(b)});return[2]})})},kc=function(a){var b=
a.sessionId&&""!==a.sessionId,c=g.__assign,d=g.__assign,e=g.__assign,f=a.hidePivot,h=a.ingressType,k=a.isSingleReview,m=a.metricsPrefix,r=a.asin,n=a.refMarker,w=a.reviewId,l=JSON,q=l.stringify;var p=a.mediaType===pa.VIDEO;p=g.__assign({imageUrl:p?a.thumbnailUrl:a.url,physicalId:a.physicalId},p&&{videoUrl:a.url});a=c.call(g,d.call(g,e.call(g,{hidePivot:f,ingressType:h,isSingleReview:k,metricsPrefix:m,productAsin:r,refMarker:n,reviewId:w,viewData:q.call(l,[p])},a.filter&&{filter:a.filter}),b&&{sessionId:a.sessionId}),
a.mediaType===pa.VIDEO?{videoUrl:a.url}:{imageUrl:a.url});return"ssnap://www.amazon.com/ive?"+mc(a)},mc=function(a){return Object.keys(a).map(function(b){return b+"="+a[b]}).join("&")},$a,nc=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(a){return[2,new Promise(function(b){P.now("mash").execute(function(c){b(c)})})]})})},Hb=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(a){switch(a.label){case 0:return $a?
[3,2]:[4,nc()];case 1:$a=a.sent(),a.label=2;case 2:return[2,$a]}})})},oc=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(a){switch(a.label){case 0:return[4,Hb()];case 1:return[2,!!a.sent()]}})})},pc=function(){function a(b){void 0===b&&(b="true");this.isSingleReviewContext=b}a.prototype.onVideoClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){switch(c.label){case 0:return[4,this.onMediaClickHandler(b)];
case 1:return c.sent(),[2]}})})};a.prototype.onImageClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){switch(c.label){case 0:return[4,this.onMediaClickHandler(b)];case 1:return c.sent(),[2]}})})};a.prototype.onMediaClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h,k;return g.__generator(this,function(m){switch(m.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=pa[d.mediatype?
d.mediatype:"IMAGE"],f=d.rank,h={reviewId:d.reviewid,mediaType:e,url:d.url,thumbnailUrl:d.thumbnailurl,physicalId:d.physicalid,asin:d.asin,isSingleReview:this.isSingleReviewContext,hidePivot:!1,refMarker:a.getIVXRefMarker(e,f),ingressType:"dpreviews",filter:e===pa.IMAGE?"image":"video",metricsPrefix:e===pa.IMAGE?"InlineReviewImageToAppX":"InlineReviewVideoToAppX",sessionId:d.sid},[4,Hb()];case 1:return k=m.sent(),[4,lc(k,h)];case 2:return m.sent(),[2]}})})};a.getIVXRefMarker=function(b,c){var d={page:Qa.SINGLE_REVIEW_PAGE,
device:Sa.MOBILE_APP,widget:Pa.INLINE,location:Ra.IMAGE},e={page:Qa.SINGLE_REVIEW_PAGE,device:Sa.MOBILE_APP,widget:Pa.INLINE,location:Ra.VIDEO};b=b===pa.IMAGE?d:e;c=c?Gb(b)+"_"+c:Gb(b);return c};return a}(),wa;(function(a){a[a.LEFT=0]="LEFT";a[a.CENTER=1]="CENTER";a[a.RIGHT=2]="RIGHT";a[a.NONE=3]="NONE"})(wa||(wa={}));var Ib;(function(a){a[a.EXPAND=0]="EXPAND";a[a.HIDE=1]="HIDE"})(Ib||(Ib={}));var Ea;(function(a){a[a.POTRAIT=0]="POTRAIT";a[a.LANDSCAPE=1]="LANDSCAPE"})(Ea||(Ea={}));var I=function(a,
b){var c,d;return b?b.querySelector("*[data-hook="+a+"]"):(null===(d=null===(c=Q["default"].cardRoot)||void 0===c?void 0:c.ownerDocument)||void 0===d?void 0:d.querySelector("*[data-hook="+a+"]"))||null},qc=function(a,b){var c;return(b=b||(null===(c=Q["default"].cardRoot)||void 0===c?void 0:c.ownerDocument))?Array.from(new Set(Array.from(b.querySelectorAll("["+a+"]")).map(function(d){return d.getAttribute(a)}).filter(function(d){return null!==d}))):[]},Ta=function(a){var b,c;return(null===(c=null===
(b=Q["default"].cardRoot)||void 0===b?void 0:b.ownerDocument)||void 0===c?void 0:c.getElementById(a))||null},aa=function(a){a.style.display="flex"},K=function(a){a.style.setProperty("display","none","important")},Jb={activate:"onclick",dataStrategy:"preload",hideHeader:!0,padding:"none"},ab=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}g.__extends(b,a);b.get=function(c,d,e,f){f=f?g.__assign(g.__assign(g.__assign({},Jb),f),{name:c}):g.__assign(g.__assign({},Jb),{name:c});
return a.createOrGet.call(this,c,d,e,f)};b.showCachedWithCallback=function(c,d){return g.__awaiter(this,void 0,void 0,function(){var e;return g.__generator(this,function(f){return(e=this.popovers[c])?[2,new Promise(function(h){P.when("A").execute(function(k){var m="a:popover:afterSlide:"+c,r=function(){k.off(m,r);h(!0)};k.on(m,r);e.show();d()})})]:[2,!1]})})};b.hideCached=function(c){return(c=this.popovers[c])?(c.hide(),!0):!1};return b}(function(){function a(b){this.popover=b}a.prototype.showSync=
function(){var b=this;return new Promise(function(c){P.when("A").execute(function(d){var e="a:popover:afterSlide:"+b.popover.name,f=function(){d.off(e,f);c()};d.on(e,f);b.show()})})};a.prototype.showWithBeforeCallback=function(b){var c=this;return new Promise(function(d){P.when("A").execute(function(e){var f="a:popover:beforeShow:"+c.popover.name,h="a:popover:afterSlide:"+c.popover.name,k=function(){b();e.off(f,k)},m=function(){e.off(h,m);d()};e.on(f,k);e.on(h,m);c.show()})})};a.prototype.show=function(){this.popover.show()};
a.prototype.hide=function(){this.popover.hide()};a.createOrGet=function(b,c,d,e){var f=this;return new Promise(function(h){f.popovers[b]?h(f.popovers[b]):P.when("a-secondary-view").execute(function(k){S["default"].scopeElement(c);k=k.create(d,e);f.popovers[b]=new a(k);h(f.popovers[b])})})};a.popovers={};return a}()),bb=function(a){return{popoverName:"cr-review-media-popover-"+a,popoverContainerSelector:"#a-popover-cr-review-media-popover-"+a,reviewMediaPopoverSelector:"#review-media-popover-content-"+
a}},Kb=function(){function a(){this.scrollIntoMediaByIndex=function(b,c){var d,e,f,h,k=!1,m=c.children;c=null===(h=null===(f=null===(e=null===(d=null===c||void 0===c?void 0:c.parentElement)||void 0===d?void 0:d.parentElement)||void 0===e?void 0:e.firstChild)||void 0===f?void 0:f.firstChild)||void 0===h?void 0:h.childNodes;for(d=0;d<m.length;d++)d===b?((null===c||void 0===c?void 0:c[d]).style.backgroundColor="#008296",aa(m[d]),k=!0):((null===c||void 0===c?void 0:c[d]).style.backgroundColor=k?"#C8CCCC":
"#008296",K(m[d]))};this.indexOfVisibleElement=function(b){for(var c=0;c<b.length;c++)if("none"!==b[c].style.display)return c;return 0}}a.prototype.onVideoClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h,k,m;return g.__generator(this,function(r){d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset;if(!((null===d||void 0===d?0:d.asin)&&(null===d||void 0===d?0:d.physicalid)&&(null===d||void 0===d?0:d.reviewid)&&(null===d||void 0===d?0:d.extension)&&(null===
d||void 0===d?0:d.thumbnailurl)))return T.log(Error("Missing required video parameters: "+JSON.stringify(d)),"ERROR"),[2];e=d.asin;f=d.physicalid;h=d.reviewid;k=d.extension;m=d.thumbnailurl;Da["default"].trigger("a:declarative:reviews:open-mweb-immersive-video-modal:click",{$event:b.event,$target:b.currentTarget,data:{asin:e,isSingleReview:!0,refMarker:"inline_review",metricsPrefix:"InlineRevToAppX",physicalId:f,slateImageUrl:m,hidePivot:!1,mediaType:"video",reviewId:h,url:"https://m.media-amazon.com/images/I/"+
f+"."+k}});return[2]})})};a.prototype.onImageClickHandler=function(b){var c,d;return g.__awaiter(this,void 0,void 0,function(){var e,f,h,k,m,r,n,w,l,q,p,D,u=this;return g.__generator(this,function(t){switch(t.label){case 0:e=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset;if(null===e||void 0===e||!e.reviewid||!((null===e||void 0===e?0:e.thumbnailid)||(null===e||void 0===e?0:e.physicalid)))return T.log(Error("Missing required image parameters: "+JSON.stringify(e)),"ERROR"),[2];f=e.reviewid;
h=e.thumbnailid||e.physicalid;k=bb(f);m=k.popoverName;r=k.popoverContainerSelector;n=function(){return u.showImageByThumbnailId(f,h||"")};return[4,ab.showCachedWithCallback(m,n)];case 1:if(t.sent())return[2];w=ua.setup(["renderPopover"]);return[4,w.renderPopover({reviewId:f})];case 2:l=t.sent();q=S["default"].cardRoot.querySelector(r);if(!q)return T.log(Error("Popover container element not found: "+r+", reviewId: "+f),"ERROR"),[2];p=null===(d=q.childNodes[0])||void 0===d?void 0:d.childNodes[0];if(!p)return T.log(Error("Could not extract popover container from DOM structure, reviewId: "+
f),"ERROR"),[2];p.appendChild(l);return[4,ab.get(m,p,b.currentTarget)];case 3:return D=t.sent(),[4,D.showWithBeforeCallback(n)];case 4:return t.sent(),[2]}})})};a.prototype.closeButtonClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e;return g.__generator(this,function(f){d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset;if(null===d||void 0===d||!d.popoverId)return T.log(Error("Missing popover ID: "+JSON.stringify(d)),"ERROR"),[2];e=bb(d.popoverId).popoverName;
ab.hideCached(e);return[2]})})};a.prototype.nextMediaClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){var c,d,e,f;return g.__generator(this,function(h){if(!b.event||!b.currentTarget)return T.log(Error("Missing event or target element"),"ERROR"),[2];var k=b.event,m=b.currentTarget;h=k.clientX/m.clientWidth*100;k=k.clientY/m.clientHeight*100;m=(m.clientWidth>m.clientHeight?Ea.LANDSCAPE:Ea.POTRAIT)===Ea.POTRAIT?{lowerBound:33,upperBound:67}:{lowerBound:40,upperBound:80};c=k<=
m.lowerBound||k>=m.upperBound?wa.NONE:25>=h?wa.LEFT:75<=h?wa.RIGHT:wa.CENTER;d=this.indexOfVisibleElement(b.currentTarget.children);e=b.currentTarget.childElementCount;f=c===wa.LEFT?(d-1+e)%e:(d+1)%e;this.scrollIntoMediaByIndex(f,b.currentTarget);return[2]})})};a.prototype.showImageByThumbnailId=function(b,c){var d=bb(b).reviewMediaPopoverSelector,e=document.querySelector(d);if(e){var f=e.querySelectorAll("[data-physicalid]");d=-1;for(var h=0;h<f.length;h++)if(f[h].dataset.physicalid===c){d=h;break}0>
d?T.log(Error("Media container not found for thumbnail ID: "+c+", reviewId: "+b),"ERROR"):(c=e.querySelector('[data-hook="ReviewMediaList"] button'))?this.scrollIntoMediaByIndex(d,c):T.log(Error("Media list button not found in popover, reviewId: "+b),"ERROR")}else T.log(Error("Review popover not found: "+d+", reviewId: "+b),"ERROR")};return a}(),ra;(function(a){a.MWEB="mWeb";a.MSHOP="mShop";a.DESKTOP="desktop"})(ra||(ra={}));var Lb=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,
function(a){switch(a.label){case 0:return[4,oc()];case 1:return[2,a.sent()]}})})},Mb=function(){return"true"===S["default"].cardRoot.getAttribute("data-mobile")||Eb["default"].isSupported("mobile")},rc=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a;return g.__generator(this,function(b){switch(b.label){case 0:return(a=Mb())?[4,Lb()]:[3,2];case 1:a=!b.sent(),b.label=2;case 2:return[2,a]}})})},sc=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a;return g.__generator(this,
function(b){switch(b.label){case 0:return[4,Lb()];case 1:if(!b.sent())return[3,2];a=ra.MSHOP;return[3,4];case 2:return[4,rc()];case 3:a=b.sent()?ra.MWEB:ra.DESKTOP,b.label=4;case 4:return[2,a]}})})},tc=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a,b,c,d;return g.__generator(this,function(e){switch(e.label){case 0:if("true"===S["default"].cardRoot.getAttribute("data-iskindleapp"))return[2,!1];if("true"!==S["default"].cardRoot.getAttribute("data-ismshop"))return[3,4];a=performance.now();
e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.race([new Promise(function(f){P.when("mash").execute(function(h){f(h)})}),new Promise(function(f,h){return setTimeout(function(){return h(Error("MASH module failed to load within 2 seconds"))},2E3)})])];case 2:return e.sent(),b=performance.now()-a,qa("MashAssetLoadTime",b),[2,!0];case 3:throw c=e.sent(),d=performance.now()-a,qa("MashAssetLoadTimeout",d),c;case 4:return[2,!1]}})})},Nb=function(){function a(b,c){this.popover=c;this.popoverOpenEventType=
"a-modal"===b?"afterShow":"afterSlide"}a.prototype.showSync=function(){var b=this;return new Promise(function(c){P.when("A").execute(function(d){var e="a:popover:"+b.popoverOpenEventType+":"+b.popover.name,f=function(){d.off(e,f);c()};d.on(e,f);b.show()})})};a.prototype.show=function(){this.popover.show()};a.prototype.hide=function(){this.popover.hide()};a.prototype.updatePosition=function(){this.popover.updatePosition()};a.getPopoverByName=function(b){return this.popovers[b]};a.prototype.isOpen=
function(){return this.popover.isActive()};a.createOrGet=function(b,c,d,e,f){var h=this;return new Promise(function(k){h.popovers[c]?k(h.popovers[c]):P.when(b).execute(function(m){S["default"].scopeElement(d);m=m.create(e,f);h.popovers[c]=new a(b,m);k(h.popovers[c])})})};a.popovers={};return a}(),uc={activate:"onclick",dataStrategy:"preload",hideHeader:!0,padding:"none"},vc={dataStrategy:"preload"};(function(a){function b(){return null!==a&&a.apply(this,arguments)||this}g.__extends(b,a);b.get=function(c,
d,e,f){f=f?g.__assign(g.__assign({},f),{name:c}):g.__assign(g.__assign({},uc),{name:c});return a.createOrGet.call(this,"a-secondary-view",c,d,e,f)};return b})(Nb);var wc=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}g.__extends(b,a);b.get=function(c,d,e,f){f=f?g.__assign(g.__assign({},f),{name:c}):g.__assign(g.__assign({},vc),{name:c});return a.createOrGet.call(this,"a-modal",c,d,e,f)};return b}(Nb),xc=function(){function a(){this.desktopPopoverModalOptions={dataStrategy:"preload",
hideHeader:!0,closeButton:!0,padding:"none",name:"cr-top-reviews-media-modal"}}a.prototype.onVideoClickHandler=function(){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(b){T.log(Error("Video click handler not implemented for desktop"),"ERROR");return[2]})})};a.prototype.onImageClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){switch(c.label){case 0:return[4,this.showImagePopover(b)];case 1:return c.sent(),
[2]}})})};a.prototype.showImagePopover=function(b){return g.__awaiter(this,void 0,void 0,function(){var c,d,e,f,h,k,m,r,n,w,l;return g.__generator(this,function(q){switch(q.label){case 0:c=b.currentTarget;if(!c)return T.log(Error("Missing trigger element"),"ERROR"),[2];d=c.dataset.reviewid;if(!d)return T.log(Error("Missing reviewId from trigger element"),"ERROR"),[2];e='[id="mediaModal_'+d+'"] div';f=S["default"].cardRoot.querySelector(e);if(!f)return T.log(Error("Popover section not found for reviewId: "+
d),"ERROR"),[2];h=f.querySelector('[data-hook="media-popover-container"] div');if(!h)return T.log(Error("Popover container not found for reviewId: "+d),"ERROR"),[2];k=this.desktopPopoverModalOptions.name+"_"+d;m=f.querySelector("div[data-reviewbind=SingleReviewMediaBlock]");r=(null===m||void 0===m?void 0:m.getAttribute("data-closebuttonaria"))||"";n=(null===m||void 0===m?void 0:m.getAttribute("data-modaltitlearia"))||"";w=g.__assign(g.__assign({},this.desktopPopoverModalOptions),{name:k,closeButtonLabel:r,
popoverLabel:n});return[4,wc.get(k,h,c,w)];case 1:return l=q.sent(),l.show(),l.updatePosition(),[2]}})})};return a}(),yc=function(){function a(){}a.getThumbnailClickHandler=function(b){void 0===b&&(b="true");return g.__awaiter(this,void 0,void 0,function(){var c;return g.__generator(this,function(d){switch(d.label){case 0:return[4,sc()];case 1:c=d.sent();switch(c){case ra.MSHOP:return[2,new pc(b)];case ra.MWEB:return[2,new Kb];case ra.DESKTOP:return[2,new xc]}return[2]}})})};return a}(),zc=function(){function a(b){this.clickHandler=
this.clickHandler=b}a.prototype.registerThumbnailClickHandlers=function(){this.registerCRVideoThumbnailClickHandler();this.registerCRImageThumbnailClickHandler()};a.prototype.registerCRVideoThumbnailClickHandler=function(){var b=this,c=J["default"].setup().define;c(Na.videoClickHandler,"click",function(d){return g.__awaiter(b,void 0,void 0,function(){return g.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.onVideoClickHandler(d)];case 1:return e.sent(),[2]}})})})};a.prototype.registerCRImageThumbnailClickHandler=
function(){var b=this,c=J["default"].setup().define;c(Na.imageClickHandler,"click",function(d){return g.__awaiter(b,void 0,void 0,function(){return g.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.onImageClickHandler(d)];case 1:return e.sent(),[2]}})})})};return a}(),cb=function(){return Z["default"].getLocation&&Z["default"].getLocation().host||location.host},db=function(){function a(b,c,d){this.reviewId=b;this.locale=c;this.sourceLanguage=d;this.reviewContainer=Ta(b);
this.reviewTextContainer=I("reviewTextContainer",this.reviewContainer);this.reviewText=I("reviewText",this.reviewContainer);this.reviewTitle=I("reviewTitle",this.reviewContainer);this.translateButton=I("translateButton",this.reviewContainer);this.seeOriginalReviewLink=I("seeOriginalReviewLink",this.reviewContainer);this.translationInfo=I("translationInfo",this.reviewContainer);this.translationSpinner=I("translationSpinner",this.reviewTextContainer);this.translationErrorMessage=I("translationErrorMessage",
this.reviewContainer);this.helpfulVoteButton=I("helpfulVoteButton",this.reviewContainer);this.helpfulVoteErrorMessage=I("helpfulVoteErrorMessage",this.reviewContainer);this.helpfulVoteSuccessMessage=I("helpfulVoteSuccessMessage",this.reviewContainer);this.helpfulVoteLoadingMessage=I("helpfulVoteLoadingMessage",this.reviewContainer);this.reportAbuseButton=I("reportAbuseButton",this.reviewContainer);this.reportAbuseSendingMessage=I("reportAbuseSendingMessage",this.reviewContainer);this.reportAbuseSuccessMessage=
I("reportAbuseSuccessMessage",this.reviewContainer);this.reportAbuseErrorMessage=I("reportAbuseErrorMessage",this.reviewContainer);this.shareButton=Ta("shareButton-"+b);this.init()}a.prototype.init=function(){this.hideTranslationSpinner()};a.prototype.updateText=function(b){var c;this.reviewTextContainer=I("reviewTextContainer",this.reviewContainer);this.reviewText=I("reviewText",this.reviewContainer);if(this.reviewTextContainer&&this.reviewText){var d=I("reviewRichContentContainer",this.reviewText);
b="reviewRichContentContainer"===b.getAttribute("data-hook")?b:I("reviewRichContentContainer",b);d&&b&&(null===(c=d.parentNode)||void 0===c?void 0:c.replaceChild(b,d))}};a.prototype.updateTitle=function(b){(this.reviewTitle=I("reviewTitle",this.reviewContainer))&&this.reviewTitle.parentNode&&(this.reviewTitle.parentNode.replaceChild(b,this.reviewTitle),this.reviewTitle=b)};a.prototype.showTranslateButton=function(){this.translateButton&&this.translationInfo&&this.seeOriginalReviewLink&&(K(this.translationInfo),
K(this.seeOriginalReviewLink),aa(this.translateButton))};a.prototype.showSeeOriginalButton=function(){this.translateButton&&this.translationInfo&&this.seeOriginalReviewLink&&(aa(this.translationInfo),aa(this.seeOriginalReviewLink),K(this.translateButton))};a.prototype.showTranslationSpinner=function(){this.translationSpinner&&(this.translationSpinner.style.display="contents")};a.prototype.hideTranslationSpinner=function(){this.translationSpinner&&K(this.translationSpinner)};a.prototype.showTranslationErrorMessage=
function(){this.translationErrorMessage&&aa(this.translationErrorMessage)};a.prototype.hideTranslationErrorMessage=function(){this.translationErrorMessage&&K(this.translationErrorMessage)};a.prototype.showHelpfulVoteSuccessMessage=function(){this.helpfulVoteErrorMessage&&this.helpfulVoteSuccessMessage&&this.helpfulVoteButton&&this.helpfulVoteLoadingMessage&&(K(this.helpfulVoteButton),K(this.helpfulVoteLoadingMessage),aa(this.helpfulVoteSuccessMessage),K(this.helpfulVoteErrorMessage))};a.prototype.showHelpfulVoteErrorMessage=
function(){this.helpfulVoteErrorMessage&&this.helpfulVoteSuccessMessage&&this.helpfulVoteButton&&this.helpfulVoteLoadingMessage&&(K(this.helpfulVoteButton),K(this.helpfulVoteLoadingMessage),K(this.helpfulVoteSuccessMessage),aa(this.helpfulVoteErrorMessage))};a.prototype.showHelpfulVoteLoadingMessage=function(){this.helpfulVoteErrorMessage&&this.helpfulVoteSuccessMessage&&this.helpfulVoteButton&&this.helpfulVoteLoadingMessage&&(K(this.helpfulVoteButton),aa(this.helpfulVoteLoadingMessage),K(this.helpfulVoteSuccessMessage),
K(this.helpfulVoteErrorMessage))};a.prototype.showReportAbuseSendingMessage=function(){this.reportAbuseButton&&this.reportAbuseSendingMessage&&this.reportAbuseSuccessMessage&&this.reportAbuseErrorMessage&&(K(this.reportAbuseButton),aa(this.reportAbuseSendingMessage),K(this.reportAbuseSuccessMessage),K(this.reportAbuseErrorMessage))};a.prototype.showReportAbuseErrorMessage=function(){this.reportAbuseButton&&this.reportAbuseSendingMessage&&this.reportAbuseSuccessMessage&&this.reportAbuseErrorMessage&&
(K(this.reportAbuseButton),K(this.reportAbuseSendingMessage),K(this.reportAbuseSuccessMessage),aa(this.reportAbuseErrorMessage))};a.prototype.showReportAbuseSuccessMessage=function(){this.reportAbuseButton&&this.reportAbuseSendingMessage&&this.reportAbuseSuccessMessage&&this.reportAbuseErrorMessage&&(K(this.reportAbuseButton),K(this.reportAbuseSendingMessage),aa(this.reportAbuseSuccessMessage),K(this.reportAbuseErrorMessage))};a.prototype.updateShareReviewURL=function(b){if(this.shareButton){var c=
this.shareButton.getAttribute("data-ssf-share-icon");c=JSON.parse(c);c.url="https://"+cb()+"/gp/aw/review/"+b+"/"+this.reviewId;this.shareButton.setAttribute("data-ssf-share-icon",JSON.stringify(c))}};a.prototype.getAsin=function(){if(this.reviewText){var b=this.reviewText.querySelector("[data-widget-model]");if(b)return b.getAttribute("data-asin")||void 0}};a.getInstance=function(b){this.instance||(this.instance=new a(b));return this.instance};return a}(),da=function(){function a(){this.singleReviewManagers=
new Map;this.locale=this.internationalTranslatedBy=this.internationalSeeOriginalButton=this.internationalTranslateAllReviewsButton=this.internationalTopReviews=this.localTranslatedBy=this.localSeeOriginalButton=this.localTranslateAllReviewsButton=this.localTopReviews=null}a.prototype.initializeDomElements=function(){if(this.localTopReviews=Ta("localTopReviews"))this.localTranslateAllReviewsButton=I("translateAllButtonContainer",this.localTopReviews),this.localSeeOriginalButton=I("seeOriginalReviewsLink",
this.localTopReviews),this.localTranslatedBy=I("translatedByContainer",this.localTopReviews);if(this.internationalTopReviews=Ta("internationalTopReviews"))this.internationalTranslateAllReviewsButton=I("translateAllButtonContainer",this.internationalTopReviews),this.internationalSeeOriginalButton=I("seeOriginalReviewsLink",this.internationalTopReviews),this.internationalTranslatedBy=I("translatedByContainer",this.internationalTopReviews)};a.prototype.getReviewManager=function(b){var c=this.singleReviewManagers.get(b);
c||(c=new db(b),this.singleReviewManagers.set(b,c));return c};a.prototype.addReviewManager=function(b,c){this.singleReviewManagers.set(b,c)};a.prototype.removeReviewManager=function(b){return this.singleReviewManagers.delete(b)};a.prototype.hasReviewManager=function(b){return this.singleReviewManagers.has(b)};a.prototype.getAllReviewIds=function(){return Array.from(this.singleReviewManagers.keys())};a.prototype.getReviewCount=function(){return this.singleReviewManagers.size};a.prototype.clear=function(){this.singleReviewManagers.clear()};
a.prototype.resetForDomReplacement=function(){this.internationalTranslatedBy=this.localTranslatedBy=this.internationalSeeOriginalButton=this.localSeeOriginalButton=this.internationalTranslateAllReviewsButton=this.localTranslateAllReviewsButton=this.internationalTopReviews=this.localTopReviews=null;this.clear()};a.prototype.getReviewIdsFromList=function(b){return(b=b?this.internationalTopReviews:this.localTopReviews)?qc("data-reviewid",b):[]};a.prototype.showTranslateAllButton=function(b){(b=b?this.internationalTranslateAllReviewsButton:
this.localTranslateAllReviewsButton)&&b&&b.classList.remove("aok-hidden")};a.prototype.hideTranslateAllButton=function(b){(b=b?this.internationalTranslateAllReviewsButton:this.localTranslateAllReviewsButton)&&b&&b.classList.add("aok-hidden")};a.prototype.showSeeOriginalButton=function(b){(b=b?this.internationalSeeOriginalButton:this.localSeeOriginalButton)&&aa(b)};a.prototype.hideSeeOriginalButton=function(b){(b=b?this.internationalSeeOriginalButton:this.localSeeOriginalButton)&&K(b)};a.prototype.showTranslatedContainer=
function(b){(b=b?this.internationalTranslatedBy:this.localTranslatedBy)&&aa(b)};a.prototype.hideTranslatedContainer=function(b){(b=b?this.internationalTranslatedBy:this.localTranslatedBy)&&K(b)};a.prototype.showTranslatedState=function(b){this.hideTranslateAllButton(b);this.showSeeOriginalButton(b);this.showTranslatedContainer(b)};a.prototype.showOriginalState=function(b){this.showTranslateAllButton(b);this.hideSeeOriginalButton(b);this.hideTranslatedContainer(b)};a.getInstance=function(){a.instance||
(a.instance=new a);return a.instance};return a}().getInstance(),sa=function(a){return da.hasReviewManager(a)?da.getReviewManager(a):db.getInstance(a)},Ac=function(){function a(){}a.registerVotingClickHandlers=function(){this.registerHelpfulVoteClickHandler()};a.registerHelpfulVoteClickHandler=function(){var b=this,c=J["default"].setup().define,d=ia["default"].setup(["helpful"]);c(La.helpfulVoteClickHandler,"click",function(e){return g.__awaiter(b,void 0,void 0,function(){var f,h,k,m,r,n,w,l;return g.__generator(this,
function(q){switch(q.label){case 0:f=e.currentTarget.dataset.id,h=e.currentTarget.dataset.asin,k=null===(w=e.currentTarget.dataset)||void 0===w?void 0:w.returnTo,m=sa(f),r=Q["default"].cardRoot.ownerDocument.activeElement,q.label=1;case 1:return q.trys.push([1,3,4,5]),m.showHelpfulVoteLoadingMessage(),[4,d.helpful({reviewId:f,domain:cb(),asin:h,returnTo:k})];case 2:return n=q.sent(),!n.success&&n.redirectUrl?Z["default"].setLocation(n.redirectUrl):n.success?m.showHelpfulVoteSuccessMessage():m.showHelpfulVoteErrorMessage(),
[3,5];case 3:return q.sent(),m.showHelpfulVoteErrorMessage(),[3,5];case 4:return r===(null===(l=e.currentTarget)||void 0===l?void 0:l.getElementsByTagName("input")[0])&&a.moveFocusToVotingMessage(f),[7];case 5:return[2]}})})})};a.moveFocusToVotingMessage=function(b){b=sa(b);var c=b.helpfulVoteSuccessMessage||b.helpfulVoteErrorMessage;c&&(c.setAttribute("tabindex","-1"),setTimeout(function(){return c.focus({preventScroll:!1})},100))};return a}(),Bc=function(){function a(){}a.registerReportClickHandlers=
function(){this.registerReportVoteClickHandler()};a.registerReportVoteClickHandler=function(){var b=this,c=J["default"].setup().define,d=ia["default"].setup(["reportAbuse"]);c(La.reportAbuseClickHandler,"click",function(e){return g.__awaiter(b,void 0,void 0,function(){var f,h,k,m,r,n,w,l;return g.__generator(this,function(q){switch(q.label){case 0:f=e.currentTarget.dataset.id,h=e.currentTarget.dataset.asin,k=null===(w=e.currentTarget.dataset)||void 0===w?void 0:w.returnTo,m=sa(f),r=Q["default"].cardRoot.ownerDocument.activeElement,
q.label=1;case 1:return q.trys.push([1,3,4,5]),m.showReportAbuseSendingMessage(),[4,d.reportAbuse({reviewId:f,domain:cb(),asin:h,returnTo:k})];case 2:return n=q.sent(),!n.success&&n.redirectUrl?Z["default"].setLocation(n.redirectUrl):n.success?m.showReportAbuseSuccessMessage():m.showReportAbuseErrorMessage(),[3,5];case 3:return q.sent(),m.showReportAbuseErrorMessage(),[3,5];case 4:return r===(null===(l=e.currentTarget)||void 0===l?void 0:l.getElementsByTagName("input")[0])&&a.moveFocusToVotingMessage(f),
[7];case 5:return[2]}})})})};a.moveFocusToVotingMessage=function(b){b=sa(b);var c=b.reportAbuseSuccessMessage||b.reportAbuseErrorMessage;c&&(c.setAttribute("tabindex","-1"),setTimeout(function(){return c.focus({preventScroll:!1})},100))};return a}(),Ob=function(a,b,c){a.setAttribute("data-a-expanded",c?"true":"false");if(a=b.querySelector(".a-css-icon"))a.className=c?"a-css-icon a-css-icon-draw a-css-icon-collapse":"a-css-icon a-css-icon-draw a-css-icon-expand";a=b.querySelector(".a-see-more-text");
b=b.querySelector(".a-see-less-text");a&&b&&(a.style.display=c?"none":"inline",b.style.display=c?"inline":"none")},Ua=function(a,b,c){void 0===b&&(b=!1);void 0===c&&(c=!1);if(!a)return a;var d=a.querySelector('[data-a-card-type="peekExpand"]');if(!d)return a;var e=d.querySelector(".a-cardui-expand-control-footer");if(!e)return a;setTimeout(function(){var f=a.parentElement;var h=null===f||void 0===f?void 0:f.parentElement;f=null===h||void 0===h?void 0:h.offsetHeight;var k=c?100:300;if(f){var m=a.offsetHeight;
f=(h=null===h||void 0===h?void 0:h.querySelector('[data-reviewbind="ImageThumbnailsBlock"]'))?Math.max(f-m+k-h.offsetHeight-8-22,k):Math.max(f-m+k-88-22,k)}else f=k;if(k=d.querySelector(".a-cardui-body .a-reactive-container"))k.style.height="auto",k.scrollHeight>=f?(b?(k.style.height=k.scrollHeight+"px",Ob(d,e,!0)):(k.style.height=f+"px",Ob(d,e,!1)),e.style.display="block"):(k.style.height="auto",d.setAttribute("data-a-expanded","true"),e.style.display="none",(f=k.querySelector(".a-reactive-container-gradient"))&&
f.remove())},0);return a},eb=function(){function a(){this.translateAllInternationalActive=this.translateAllLocalActive=!1;this.locale="";this.isMobile=!1;this.cache=new Map;this.translateableReviewIds=new Set;this.ignoreReviewIds=new Set;this.translateAllInternationalActive=this.translateAllLocalActive=!1;this.remoteDataOperationProxy=ia["default"].setup(["translateReview"])}a.prototype.addReviewIdsToTranslatableReviewIds=function(b){this.translateableReviewIds.add(b)};a.prototype.getTranslatableReviewIds=
function(){return Array.from(this.translateableReviewIds)};a.prototype.addReviewdIdsToIgnoreList=function(b){this.ignoreReviewIds.add(b)};a.prototype.categorizeReview=function(b,c,d){c===d?this.addReviewdIdsToIgnoreList(b):this.addReviewIdsToTranslatableReviewIds(b)};a.prototype.initialize=function(b,c,d,e){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(f){switch(f.label){case 0:return this.isMobile=b,this.locale=c,d&&e?[4,this.handleSingleReviewAutoTranslation(d,
e)]:[3,2];case 1:return f.sent(),[2];case 2:return[4,this.handleCookieBasedTranslation()];case 3:return f.sent(),[2]}})})};a.prototype.setTranslateCookie=function(b){Da["default"].trigger("cm-cr-sticky-translate-set",b)};a.prototype.setCookieForTranslateAll=function(){this.setTranslateCookie("1")};a.prototype.setCookieForShowOriginal=function(){this.setTranslateCookie("fr-CA"===this.locale?"2":"-1")};a.prototype.renderTranslations=function(){return g.__awaiter(this,void 0,void 0,function(){var b,
c;return g.__generator(this,function(d){switch(d.label){case 0:return b=da.getReviewIdsFromList(!1),c=da.getReviewIdsFromList(!0),0<b.length&&this.translateAllLocalActive?[4,this.renderAllTranslatedReviews(b)]:[3,2];case 1:d.sent(),da.showTranslatedState(!1),d.label=2;case 2:return 0<c.length&&this.translateAllInternationalActive?[4,this.renderAllTranslatedReviews(c)]:[3,4];case 3:d.sent(),da.showTranslatedState(!0),d.label=4;case 4:return[2]}})})};a.prototype.renderAllTranslatedReviews=function(b,
c){void 0===c&&(c=!1);return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h,k,m,r,n,w,l,q,p,D,u,t,y=this;return g.__generator(this,function(A){switch(A.label){case 0:c&&this.setCookieForTranslateAll();this.updateListStates(b,!0);d=ia["default"].setup(["translateAllReviews"]);e=b.map(function(x){return sa(x)});f=[];try{for(h=g.__values(b),k=h.next();!k.done;k=h.next())m=k.value,r=this.cache.get(m),n=e[b.indexOf(m)],r&&r.translatedText&&r.translatedTitle?(n.hideTranslationErrorMessage(),n.updateText(r.translatedText.cloneNode(!0)),
n.updateTitle(r.translatedTitle.cloneNode(!0)),n.showSeeOriginalButton(),Ua(n.reviewContainer,!1,this.isMobile)):this.ignoreReviewIds.has(m)||(f.push(m),n.hideTranslationErrorMessage(),n.showTranslationSpinner())}catch(x){u={error:x}}finally{try{k&&!k.done&&(t=h.return)&&t.call(h)}finally{if(u)throw u.error;}}if(!(0<f.length))return[3,6];A.label=1;case 1:return A.trys.push([1,5,,6]),[4,d.translateAllReviews({reviewIds:f,isMobile:this.isMobile})];case 2:return w=A.sent(),l=new Map,q=new Map,p=[],D=
[],w.forEach(function(x){x&&x.reviewId&&(l.set(x.reviewId,x),x.translatedText&&x.translatedTitle?q.set(x.reviewId,x):422===x.statusCode?p.push(x):D.push(x.reviewId))}),f.forEach(function(x){l.has(x)||D.push(x)}),0<q.size?[4,Promise.allSettled(Array.from(q.entries()).map(function(x){x=g.__read(x,2);var M=x[0],C=x[1];return g.__awaiter(y,void 0,void 0,function(){var v;return g.__generator(this,function(B){switch(B.label){case 0:return v=e[b.indexOf(M)],[4,this.applyTranslationToReview(M,v,C,!1)];case 1:return B.sent(),
[2]}})})}))]:[3,4];case 3:A.sent(),A.label=4;case 4:return D.forEach(function(x){x=e[b.indexOf(x)];x.hideTranslationSpinner();x.showTranslationErrorMessage()}),p.forEach(function(x){var M=y.getRetryTime(x);setTimeout(function(){y.renderTranslatedReview(x.reviewId,a.DEFAULT_RETRIES-1)},1E3*M)}),[3,6];case 5:return A.sent(),e.forEach(function(x){x.hideTranslationSpinner();x.showTranslationErrorMessage()}),[3,6];case 6:return[2]}})})};a.prototype.renderTranslatedReview=function(b,c){void 0===c&&(c=a.DEFAULT_RETRIES);
return g.__awaiter(this,void 0,void 0,function(){var d,e,f;return g.__generator(this,function(h){switch(h.label){case 0:d=sa(b);e=this.cache.get(b);if(!(e&&e.translatedText&&e.translatedTitle))return[3,1];d.hideTranslationErrorMessage();d.updateText(e.translatedText.cloneNode(!0));d.updateTitle(e.translatedTitle.cloneNode(!0));d.showSeeOriginalButton();Ua(d.reviewContainer,!0,this.isMobile);return[3,7];case 1:d.hideTranslationErrorMessage(),d.showTranslationSpinner(),h.label=2;case 2:return h.trys.push([2,
6,,7]),[4,this.translateReviewDataOperation(b,c)];case 3:return(f=h.sent())&&f.translatedText&&f.translatedTitle?[4,this.applyTranslationToReview(b,d,f,!0)]:[3,5];case 4:h.sent(),h.label=5;case 5:return[3,7];case 6:return h.sent(),d.hideTranslationSpinner(),d.showTranslationErrorMessage(),[3,7];case 7:return[2]}})})};a.prototype.translateReviewDataOperation=function(b,c){void 0===c&&(c=a.DEFAULT_RETRIES);return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h;return g.__generator(this,function(k){switch(k.label){case 0:d=
function(m){var r,n;return g.__generator(this,function(w){switch(w.label){case 0:return[4,e.remoteDataOperationProxy.translateReview({reviewId:b})];case 1:return r=w.sent(),r.translatedText&&r.translatedTitle?[2,{value:r}]:[3,2];case 2:if(!r.statusCode||422!==r.statusCode)return[3,4];n=e.getRetryTime(r);return[4,new Promise(function(l){return setTimeout(l,1E3*n)})];case 3:w.sent(),w.label=4;case 4:return[2]}})},e=this,f=0,k.label=1;case 1:return f<c?[5,d(f)]:[3,4];case 2:h=k.sent();if("object"===
typeof h)return[2,h.value];k.label=3;case 3:return f++,[3,1];case 4:throw Error("Translation failed after retries");}})})};a.prototype.renderOriginalReviews=function(b,c){void 0===c&&(c=!1);return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h,k,m;return g.__generator(this,function(r){switch(r.label){case 0:c&&this.setCookieForShowOriginal(),this.updateListStates(b,!1),r.label=1;case 1:r.trys.push([1,6,7,8]),d=g.__values(b),e=d.next(),r.label=2;case 2:if(e.done)return[3,5];f=e.value;return[4,
this.renderOriginalReview(f,!1)];case 3:r.sent(),r.label=4;case 4:return e=d.next(),[3,2];case 5:return[3,8];case 6:return h=r.sent(),k={error:h},[3,8];case 7:try{e&&!e.done&&(m=d.return)&&m.call(d)}finally{if(k)throw k.error;}return[7];case 8:return[2]}})})};a.prototype.renderOriginalReview=function(b,c){void 0===c&&(c=!0);return g.__awaiter(this,void 0,void 0,function(){var d,e;return g.__generator(this,function(f){d=sa(b);(e=this.cache.get(b))&&e.originalText&&e.originalTitle&&(d.hideTranslationErrorMessage(),
d.updateText(e.originalText.cloneNode(!0)),d.updateTitle(e.originalTitle.cloneNode(!0)),d.showTranslateButton(),Ua(d.reviewContainer,c,Mb()));return[2]})})};a.prototype.handleSingleReviewAutoTranslation=function(b,c){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(d){switch(d.label){case 0:return"fr-CA"!==this.locale||"fr-CA"===c?[3,2]:[4,this.renderTranslatedReview(b)];case 1:d.sent(),d.label=2;case 2:return[2]}})})};a.prototype.handleCookieBasedTranslation=function(){return g.__awaiter(this,
void 0,void 0,function(){var b=this;return g.__generator(this,function(c){switch(c.label){case 0:return 0===this.getTranslatableReviewIds().length?[2]:"fr-CA"!==this.locale?[3,2]:[4,this.renderAllTranslatedReviews(this.getTranslatableReviewIds(),!0)];case 1:return c.sent(),[2];case 2:return P.when("cm-cr-sticky-translate-cookie-handler-allreviews-hz").execute(function(d){return g.__awaiter(b,void 0,void 0,function(){var e;return g.__generator(this,function(f){switch(f.label){case 0:e=d.getCookie();
if("1"!==e)return[3,2];this.translateAllInternationalActive=this.translateAllLocalActive=!0;return[4,this.renderTranslations()];case 1:f.sent(),f.label=2;case 2:return[2]}})})}),[2]}})})};a.prototype.applyTranslationToReview=function(b,c,d,e){return g.__awaiter(this,void 0,void 0,function(){var f,h,k,m,r,n,w,l,q,p,D,u;return g.__generator(this,function(t){switch(t.label){case 0:f=this.cache.get(b),h=c.reviewText?I("reviewRichContentContainer",c.reviewText):null,k=(null===f||void 0===f?void 0:f.originalText)||
(h?h.cloneNode(!0):null),m=(null===f||void 0===f?void 0:f.originalTitle)||(c.reviewTitle?c.reviewTitle.cloneNode(!0):null),t.label=1;case 1:return t.trys.push([1,3,,4]),r=c.getAsin(),n=ia["default"].setup(["renderReviewTitle","renderReviewText"]),[4,Promise.all([n.renderReviewText({isCardExpanded:e,language:d.targetLanguage,text:d.translatedText,isMobile:this.isMobile,reviewId:b,asin:r}),n.renderReviewTitle({language:d.targetLanguage,isMobile:this.isMobile,title:d.translatedTitle})])];case 2:return w=
g.__read.apply(void 0,[t.sent(),2]),l=w[0],q=w[1],p=oa.unscope(l),D=oa.unscope(q),u=I("reviewRichContentContainer",p),this.cache.set(b,{originalText:k,originalTitle:m,targetLanguage:d.targetLanguage,translatedText:u||p,translatedTitle:D}),p&&D?(c.hideTranslationErrorMessage(),c.hideTranslationSpinner(),c.updateText(p),c.updateTitle(D),c.showSeeOriginalButton(),Ua(c.reviewContainer,e,this.isMobile)):(c.hideTranslationSpinner(),c.showTranslationErrorMessage()),[3,4];case 3:return t.sent(),c.hideTranslationSpinner(),
c.showTranslationErrorMessage(),[3,4];case 4:return[2]}})})};a.prototype.updateListStates=function(b,c){var d=da.getReviewIdsFromList(!1),e=da.getReviewIdsFromList(!0),f=b.some(function(h){return d.includes(h)});b=b.some(function(h){return e.includes(h)});f&&((this.translateAllLocalActive=c)?da.showTranslatedState(!1):da.showOriginalState(!1));b&&((this.translateAllInternationalActive=c)?da.showTranslatedState(!0):da.showOriginalState(!0))};a.prototype.getRetryTime=function(b){return Math.min((null===
b||void 0===b?void 0:b.retryDelayinSeconds)||a.DEFAULT_RETRY_TIME,3)};a.getInstance=function(){a.instance||(a.instance=new a);return a.instance};a.DEFAULT_RETRIES=3;a.DEFAULT_RETRY_TIME=2;return a}().getInstance(),Cc=function(){function a(){}a.registerTranslationClickHandlers=function(){a.registerTranslateButtonClickHandler();a.registerSeeOriginalReviewButtonClickHandler()};a.registerTranslateButtonClickHandler=function(){var b=J["default"].setup().define;b(Ma.requestTranslationClickHandler,"click",
function(c){return g.__awaiter(void 0,void 0,void 0,function(){var d,e,f;return g.__generator(this,function(h){switch(h.label){case 0:return d=null===(e=c.currentTarget)||void 0===e?void 0:e.dataset.reviewid,[4,eb.renderTranslatedReview(d)];case 1:return h.sent(),Q["default"].cardRoot.ownerDocument.activeElement===(null===(f=c.currentTarget)||void 0===f?void 0:f.firstChild)&&a.moveFocusToReviewText(d),[2]}})})})};a.registerSeeOriginalReviewButtonClickHandler=function(){var b=J["default"].setup().define;
b(Ma.seeOriginalReviewClickHandler,"click",function(c){return g.__awaiter(void 0,void 0,void 0,function(){var d,e,f;return g.__generator(this,function(h){switch(h.label){case 0:return d=null===(e=c.currentTarget)||void 0===e?void 0:e.dataset.reviewid,[4,eb.renderOriginalReview(d)];case 1:return h.sent(),Q["default"].cardRoot.ownerDocument.activeElement===(null===(f=c.currentTarget)||void 0===f?void 0:f.firstChild)&&a.moveFocusToReviewText(d),[2]}})})})};a.moveFocusToReviewText=function(b){var c=sa(b);
b=c.reviewText;null===b||void 0===b?void 0:b.setAttribute("tabindex","-1");b&&setTimeout(function(){var d;return null===(d=c.reviewText)||void 0===d?void 0:d.focus({preventScroll:!1})},100)};return a}(),Dc=function(){function a(){}a.getMediaPopoverClickHandler=function(){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(b){return[2,new Kb]})})};return a}(),Ec=function(){function a(b){this.clickHandler=b}a.prototype.registerMediaPopoverClickHandlers=function(){this.registerCloseButtonClickHandler();
this.registerNextMediaClickHandler()};a.prototype.registerNextMediaClickHandler=function(){var b=this,c=J["default"].setup().define;c(Oa.popoverNextMediaClickHandler,"click",function(d){return g.__awaiter(b,void 0,void 0,function(){return g.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.nextMediaClickHandler(d)];case 1:return e.sent(),[2]}})})})};a.prototype.registerCloseButtonClickHandler=function(){var b=this,c=J["default"].setup().define;c(Oa.popoverCloseButtonClickHandler,
"click",function(d){return g.__awaiter(b,void 0,void 0,function(){return g.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.closeButtonClickHandler(d)];case 1:return e.sent(),[2]}})})})};return a}(),Fc=function(a){void 0===a&&(a="true");return g.__awaiter(void 0,void 0,void 0,function(){var b,c,d,e,f;return g.__generator(this,function(h){switch(h.label){case 0:b=!1,h.label=1;case 1:return h.trys.push([1,3,,4]),[4,tc()];case 2:return(b=h.sent())&&qa("client.earlyMashInitialization.success",
1),[3,4];case 3:return h.sent(),qa("client.earlyMashInitialization.error",1),b=!1,[3,4];case 4:return[4,yc.getThumbnailClickHandler(a)];case 5:return c=h.sent(),d=new zc(c),d.registerThumbnailClickHandlers(),[4,Dc.getMediaPopoverClickHandler()];case 6:return e=h.sent(),f=new Ec(e),f.registerMediaPopoverClickHandlers(),Cc.registerTranslationClickHandlers(),Ac.registerVotingClickHandlers(),Bc.registerReportClickHandlers(),[2]}})})},Gc=function(a){return g.__awaiter(void 0,void 0,void 0,function(){var b,
c,d,e,f,h,k;return g.__generator(this,function(m){switch(m.label){case 0:return b=a||S["default"].cardRoot,c=b.getAttribute("data-reviewid")||b.id,d="true"===b.getAttribute("data-mobile"),e=b.getAttribute("data-asin")||"",f=b.getAttribute("data-locale")||"",h=b.getAttribute("data-sourcelanguage")||"",c?a?[3,2]:[4,eb.initialize(d,f,c,h)]:[2,null];case 1:m.sent(),m.label=2;case 2:return k=new db(c,f,h),k.updateShareReviewURL(e),[2,k]}})})},H;(function(a){a.IMAGE="IMAGE";a.VIDEO="VIDEO";a.MIXED="MIXED"})(H||
(H={}));var fb=H,gb,Hc=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(a){return[2,new Promise(function(b){P.now("mash").execute(function(c){b(c)})})]})})},hb=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(a){switch(a.label){case 0:return gb?[3,2]:[4,Hc()];case 1:gb=a.sent(),a.label=2;case 2:return[2,gb]}})})},Ic=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,
function(a){switch(a.label){case 0:return[4,hb()];case 1:return[2,!!a.sent()]}})})},G=function(){function a(){}a.setPrefix=function(b){this.prefix=b+"."};a.logCounter=function(b,c,d){Bb.count(""+this.prefix+(d?d+"."+b:b),c)};a.logError=function(b,c){this.logCounter(b,1,c)};a.logNoError=function(b,c){this.logCounter(b,0,c)};a.prefix="";return a}(),ja;(function(a){a.MWEB="mWeb";a.MSHOP="mShop";a.DESKTOP="desktop"})(ja||(ja={}));var Fa=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,
function(a){switch(a.label){case 0:return[4,Ic()];case 1:return[2,a.sent()]}})})},Pb=function(){return"true"===S["default"].cardRoot.getAttribute("data-mobile")||Eb["default"].isSupported("mobile")},Jc=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a;return g.__generator(this,function(b){switch(b.label){case 0:return(a=Pb())?[4,Fa()]:[3,2];case 1:a=!b.sent(),b.label=2;case 2:return[2,a]}})})},Kc=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a,b;return g.__generator(this,
function(c){switch(c.label){case 0:return(b=a="true"===S["default"].cardRoot.getAttribute("data-mshop-beta"))?[4,Fa()]:[3,2];case 1:b=c.sent(),c.label=2;case 2:return[2,b]}})})},Lc=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a,b;return g.__generator(this,function(c){switch(c.label){case 0:return(b=a="true"===S["default"].cardRoot.getAttribute("data-ios"))?[4,Fa()]:[3,2];case 1:b=c.sent(),c.label=2;case 2:return[2,b]}})})},Mc=function(){return g.__awaiter(void 0,void 0,void 0,
function(){var a,b;return g.__generator(this,function(c){switch(c.label){case 0:return(b=a="true"===S["default"].cardRoot.getAttribute("data-android"))?[4,Fa()]:[3,2];case 1:b=c.sent(),c.label=2;case 2:return[2,b]}})})},Qb=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a;return g.__generator(this,function(b){switch(b.label){case 0:return[4,Fa()];case 1:if(!b.sent())return[3,2];a=ja.MSHOP;return[3,4];case 2:return[4,Jc()];case 3:a=b.sent()?ja.MWEB:ja.DESKTOP,b.label=4;case 4:return[2,
a]}})})},Nc=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a,b,c,d;return g.__generator(this,function(e){switch(e.label){case 0:if("true"===S["default"].cardRoot.getAttribute("data-kindle-app"))return[2,!1];if("true"!==S["default"].cardRoot.getAttribute("data-mshop"))return[3,4];a=performance.now();e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.race([new Promise(function(f){P.when("mash").execute(function(h){f(h)})}),new Promise(function(f,h){return setTimeout(function(){return h(Error("MASH module failed to load within 2 seconds"))},
2E3)})])];case 2:return e.sent(),b=performance.now()-a,G.logCounter("MashAssetLoadTime",b),[2,!0];case 3:throw c=e.sent(),d=performance.now()-a,G.logCounter("MashAssetLoadTimeout",d),c;case 4:return[2,!1]}})})},ib;(ib||(ib={})).clickHandler="CRImageThumbnailOpsClickHandler";var Oc=ib,jb;(jb||(jb={})).clickHandler="CRSeeMoreThumbnailOpsClickHandler";var Pc=jb,kb;(kb||(kb={})).clickHandler="CRVideoThumbnailClickHandler";var Qc=kb,ha;(function(a){a.IMAGE="image";a.VIDEO="video";a.MIXED="mixed"})(ha||
(ha={}));var Ga=function(){function a(b,c){this.popover=c;this.popoverOpenEventType="a-modal"===b?"afterShow":"afterSlide"}a.prototype.showSync=function(){var b=this;return new Promise(function(c){P.when("A").execute(function(d){var e="a:popover:"+b.popoverOpenEventType+":"+b.popover.name,f=function(){d.off(e,f);c()};d.on(e,f);b.show()})})};a.prototype.show=function(){this.popover.show()};a.prototype.hide=function(){this.popover.hide()};a.prototype.updatePosition=function(){this.popover.updatePosition()};
a.getPopoverByName=function(b){return this.popovers[b]};a.prototype.isOpen=function(){return this.popover.isActive()};a.createOrGet=function(b,c,d,e,f){var h=this;return new Promise(function(k){h.popovers[c]?k(h.popovers[c]):P.when(b).execute(function(m){S["default"].scopeElement(d);m=m.create(e,f);h.popovers[c]=new a(b,m);k(h.popovers[c])})})};a.popovers={};return a}(),Rc={activate:"onclick",dataStrategy:"preload",hideHeader:!0,padding:"none"},Rb={dataStrategy:"preload"},Sc=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}g.__extends(b,a);b.get=function(c,d,e,f){f=f?g.__assign(g.__assign({},f),{name:c}):g.__assign(g.__assign({},Rc),{name:c});return a.createOrGet.call(this,"a-secondary-view",c,d,e,f)};return b}(Ga),Tc=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}g.__extends(b,a);b.get=function(c,d,e,f){f=f?g.__assign(g.__assign({},f),{name:c}):g.__assign(g.__assign({},Rb),{name:c});return a.createOrGet.call(this,"a-modal",c,d,e,f)};return b}(Ga),Uc=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}g.__extends(b,a);b.get=function(c,d,e,f){f=f?g.__assign(g.__assign({},f),{name:c}):g.__assign(g.__assign({},Rb),{name:c});return a.createOrGet.call(this,"a-popover",c,d,e,f)};return b}(Ga),O=function(a){a.style.display="flex"},L=function(a){a.style.display="none"},X;(function(a){a[a.LEFT=0]="LEFT";a[a.CENTER=1]="CENTER";a[a.RIGHT=2]="RIGHT";a[a.NONE=3]="NONE"})(X||(X={}));var za;(function(a){a[a.EXPAND=0]="EXPAND";a[a.HIDE=1]="HIDE"})(za||(za={}));var Ha;(function(a){a[a.POTRAIT=
0]="POTRAIT";a[a.LANDSCAPE=1]="LANDSCAPE"})(Ha||(Ha={}));var R=function(a,b){return(a=null===a||void 0===a?void 0:a.getElementsByClassName(b))?a[0]:null},Va=function(a,b){var c;return null!==(c=null===a||void 0===a?void 0:a.querySelector(b))&&void 0!==c?c:null},z=function(a,b){a&&b(a)},Sb=function(a){a=a.dataset;return{asin:a.asin,mediaType:H[a.mediatype],reviewId:a.reviewid,mediaId:a.physicalid||a.mediaid}},Tb=function(a,b){null===b||void 0===b?void 0:b.classList.remove(a)},Ub=function(a,b){null===
b||void 0===b?void 0:b.classList.add(a)},Vc=function(a){var b=R(a,"_Y3Itb_desktop-skeleton-container_738lf"),c=R(a,"_Y3Itb_desktop-spinner-container_1qNHr");return{show:function(){return z(b,function(d){return O(d)})},hide:function(){return z(b,function(d){return L(d)})},setLoadingAnimation:function(d){z(c,function(e){d?b&&O(e):L(e)})}}},lb;(function(a){a.SingleReviewComponent="SingleReviewComponent";a.ProfileBlock="ProfileBlock";a.ProfileBadge="ProfileBadge";a.Rating="Rating";a.RatingAlt="RatingAlt";
a.ReviewText="ReviewText";a.ReviewTitle="ReviewTitle";a.MainMedia="MainMedia";a.ImageThumbnailsBlock="ImageThumbnailsBlock";a.GalleryBlock="GalleryBlock";a.SingleReviewMediaBlock="SingleReviewMediaBlock"})(lb||(lb={}));var F=lb,mb;(function(a){a.MainMedia="MainMedia";a.ImageThumbnailsBlock="ImageThumbnailsBlock";a.GalleryBlock="GalleryBlock";a.SingleReviewMediaBlock="SingleReviewMediaBlock"})(mb||(mb={}));var Vb=mb,nb;(function(a){a.THANKYOU_MESSAGE_TOAST_BAR_NAME="thankYouMessageToastBarName";a.ERROR_MESSAGE_TOAST_BAR_NAME=
"errorMessageToastBarName";a.LOADPOPOVER_ERROR_TOAST_BAR_NAME="loadPopoverErrorToastBarName";a.DATA_POPOVER_NAME="data-popovername";a.DATA_ASIN="data-asin";a.DATA_MEDIATYPE="data-mediatype";a.DATA_SHOW_GALLERY_IN_MODAL="data-showgalleryinmodal";a.DATA_REVIEW_ID="data-reviewid";a.DATA_MEDIA_ID="data-mediaid";a.DATA_CSA_C_TYPE="data-csa-c-type";a.DATA_CSA_SLOT_ID="data-csa-c-slot-id";a.DATA_MULTIPLE_STARS_SUFFIX="data-multiple-starts-suffix";a.DATA_ONE_STAR_SUFFIX="data-one-star-suffix";a.DATA_IMAGE_ALT_TEXT=
"data-imagealttext"})(nb||(nb={}));var N=nb,ob;(function(a){a.showMediaGalleryClickHandler="showMediaGalleryClickHandler";a.galleryItemClickHandler="galleryItemClickHandler";a.thumbnailClickHandler="thumbnailClickHandler";a.expandTextClickHandler="expandTextClickHandler";a.hideTextClickHandler="hideTextClickHandler";a.reloadMediaPopover="reloadMediaPopover";a.closeMediaPopover="closeMediaPopover";a.leftClickHandler="leftClickHandler";a.rightClickHandler="rightClickHandler";a.openReportConfirmationDialogClickHandler=
"OpenReportConfirmationDialogClickHandler";a.confirmReportAbuseClickHandler="ConfirmReportAbuseClickHandler";a.noopHandler="noopHandler";a.helpfulVoteClickHandler="HelpfulVoteClickHandler"})(ob||(ob={}));var Y=ob,U;(function(a){a.UPDATE_TEXT="updateText";a.UPDATE_LANG="updateLang";a.REPLACE_CLASS="replaceClass";a.DELETE_CHILDREN="deleteChildren";a.APPEND_ELEMENT="appendElement";a.UPDATE_ELEMENT="UpdateElement"})(U||(U={}));var pb=function(a,b,c){a=Va(a,"[data-reviewbind="+F[b]+"]");c&&a&&(a=Va(a,
c));return a},Wb=function(a){var b=Q["default"].cardRoot.ownerDocument.createElement(a.tag);z(a.elementAttributes,function(c){Object.keys(c).forEach(function(d){return b.setAttribute(d,c[d])})});z(a.children,function(c){c.forEach(function(d){d=Wb(d);b.append(d)})});z(a.observer,function(c){c.observe(b)});z(a.clickHandler,function(c){c(b)});z(a.textContent,function(c){return b.textContent=c});return b},Xb=function(a,b){switch(b.type){case U.UPDATE_TEXT:z(a,function(c){var d,e=null!==(d=b.textContent)&&
void 0!==d?d:"";c.textContent=e});break;case U.UPDATE_LANG:z(a,function(c){var d,e,f=c.textContent||"",h=c.dataset.reviewlanguage||"",k=c.dataset.originalText,m=null!==(d=b.textContent)&&void 0!==d?d:"";d=null===(e=c.dataset.locale)||void 0===e?void 0:e.slice(0,2);e=new Intl.DisplayNames([d],{type:"language"});k||(c.dataset.originalText=f);if("updateLang"==m){if(h=h.slice(0,2),h=e.of(h))c.textContent=f.replace("*",h)}else k&&(c.textContent=c.dataset.originalText||"")});break;case U.REPLACE_CLASS:z(a,
function(c){z(b.classPatternToBeReplaced,function(d){var e=Array.from(c.classList).find(function(f){return f.match(d)});z(e,function(f){return c.classList.remove(f)})});z(b.newClass,function(d){return c.classList.add(d)})});break;case U.APPEND_ELEMENT:z(a,function(c){var d;null===(d=b.elements)||void 0===d?void 0:d.forEach(function(e){c.append(Wb(e))})});break;case U.DELETE_CHILDREN:z(a,function(c){for(;c.lastElementChild;)c.removeChild(c.lastElementChild)});break;case U.UPDATE_ELEMENT:z(a,function(c){z(b.elementAttributes,
function(d){Object.keys(d).forEach(function(e){return c.setAttribute(e,d[e])})})})}},qb=function(a,b){a&&b.forEach(function(c){var d=pb(a,c.key,c.querySelector);Xb(d,c)})},Wc=function(a,b){var c=b==H.IMAGE?"cm_cr_image_carousel_popover":"cm_cr_video_carousel_popover",d=J["default"].setup(),e=function(u,t){var y,A=null!==(y=t.mediaList.findIndex(b==H.IMAGE?function(x){var M;return(null===(M=x.image)||void 0===M?void 0:M.physicalId)==u}:function(x){var M;return(null===(M=x.video)||void 0===M?void 0:
M.physicalId)==u}))&&void 0!==y?y:0;return t.mediaList[A]},f=function(u,t,y){return[{type:U.UPDATE_TEXT,key:u,textContent:t,querySelector:y}]},h=function(u,t,y,A){return[{type:U.REPLACE_CLASS,key:u,classPatternToBeReplaced:t,newClass:y,querySelector:A}]},k=function(u,t,y){return[{key:u,type:U.UPDATE_ELEMENT,elementAttributes:t,querySelector:y}]},m=["_Y3Itb_media-popover-image-view-container_vTrQA","_Y3Itb_media-popover-image-view-active_2lj7U"],r=function(u){var t=u.mediaGroup.mediaList.map(function(y){return b==
H.IMAGE?y.image:y.video}).filter(function(y){return!!y}).map(function(y,A){var x,M=g.__assign,C=(x={class:u.mediaId==y.physicalId?m.join(" "):"_Y3Itb_media-popover-image-view-container_vTrQA"},x[N.DATA_MEDIA_ID]=y.physicalId,x);x=c+"_"+u.reviewId+"_"+u.reviewRank+"_"+y.physicalId+"_"+A;var v;A=(v={},v[N.DATA_CSA_C_TYPE]="element",v[N.DATA_CSA_SLOT_ID]=x,v);return{tag:"div",elementAttributes:M.call(g,C,A),children:[{tag:b==H.IMAGE?"img":"video",elementAttributes:g.__assign({src:y.url,alt:y.altText,
class:"_Y3Itb_media-popover-image-view_1FAQo"},b==H.VIDEO?{controls:"true"}:{})}]}});return[{type:U.DELETE_CHILDREN,key:F.MainMedia},{type:U.APPEND_ELEMENT,elements:t,key:F.MainMedia}]},n=function(u){if(b==H.VIDEO)return[];var t=l(F.ImageThumbnailsBlock,N.DATA_IMAGE_ALT_TEXT),y=u.mediaGroup.mediaList.map(function(A){return A.image}).filter(function(A){return!!A}).map(function(A){var x;return{tag:"li",elementAttributes:{class:"_Y3Itb_media-popover-list-item-style_1njtu"},children:[{tag:"button",elementAttributes:(x=
{"aria-pressed":u.mediaId===A.physicalId?"true":"false",class:u.mediaId===A.physicalId?"_Y3Itb_media-popover-thumbnail-image-view-active_2W42O _Y3Itb_media-popover-thumbnail-image-button_1vtKQ":"_Y3Itb_media-popover-thumbnail-image-button_1vtKQ"},x[N.DATA_MEDIA_ID]=A.physicalId,x[N.DATA_MEDIATYPE]=b,x),children:[{tag:"img",elementAttributes:{src:A.thumbnailUrl,alt:t,class:"_Y3Itb_media-popover-thumbnail-image-view_3-Y40"}}],clickHandler:function(M){return d.attach(Y.thumbnailClickHandler,M)}}]}});
return[{type:U.DELETE_CHILDREN,key:F.ImageThumbnailsBlock},{type:U.APPEND_ELEMENT,elements:y,key:F.ImageThumbnailsBlock}]},w=function(u,t,y){return g.__spread(f(u,y),k(u,{lang:t}))},l=function(u,t,y){var A;return(u=pb(a,u,y))?null!==(A=u.getAttribute(t))&&void 0!==A?A:"":""},q=l(F.RatingAlt,N.DATA_MULTIPLE_STARS_SUFFIX),p=l(F.RatingAlt,N.DATA_ONE_STAR_SUFFIX),D=function(u,t,y){var A,x,M,C,v,B;switch(u){case F.ReviewText:return w(u,(null===(x=y.metadata)||void 0===x?void 0:x.sourceLanguage)||"",null===
(M=y.metadata)||void 0===M?void 0:M.text);case F.ReviewTitle:return w(u,(null===(C=y.metadata)||void 0===C?void 0:C.sourceLanguage)||"",null===(v=y.metadata)||void 0===v?void 0:v.title);case F.ProfileBadge:return f(u,t.mediaGroup.contributorRelationships);case F.Rating:var E=null===(B=y.metadata)||void 0===B?void 0:B.rating;void 0===E&&(E=0);return g.__spread(h(F.Rating,"^a-star-.*","a-star-"+E),f(F.Rating,E+" "+(1<E?q:p),"span"));case F.MainMedia:return r(t);case F.ProfileBlock:return B=(B=t.mediaGroup.contributor.profile)?
g.__spread(f(F.ProfileBlock,B.name,".a-profile-name"),k(F.ProfileBlock,{src:B.avatarUrl.desktop},".a-profile-avatar > img"),k(F.ProfileBlock,{href:null!==(E=B.link)&&void 0!==E?E:"javascript:void(0)"},"a.a-profile")):[],B;case F.ImageThumbnailsBlock:return n(t);case F.SingleReviewMediaBlock:return k(u,(A={},A[N.DATA_CSA_SLOT_ID]=c+"_"+t.reviewId+"_"+t.reviewRank,A));default:return[]}};return{updateReview:function(u){var t=e(u.mediaId,u.mediaGroup),y=Object.keys(F).flatMap(function(A){return D(F[A],
u,t)});qb(a,y)},updateReviewMedia:function(u){var t=e(u.mediaId,u.mediaGroup),y=Object.keys(Vb).flatMap(function(A){return D(Vb[A],u,t)});qb(a,y)},updateMedia:function(u){u=g.__spread(k(F.ImageThumbnailsBlock,{"aria-pressed":"false"},"._Y3Itb_media-popover-thumbnail-image-view-active_2W42O"),k(F.ImageThumbnailsBlock,{"aria-pressed":"true"},'button[data-mediaid="'+u+'"]'),h(F.ImageThumbnailsBlock,"_Y3Itb_media-popover-thumbnail-image-view-active_2W42O",void 0,"._Y3Itb_media-popover-thumbnail-image-view-active_2W42O"),
h(F.ImageThumbnailsBlock,void 0,"_Y3Itb_media-popover-thumbnail-image-view-active_2W42O",'button[data-mediaid="'+u+'"]'),h(F.MainMedia,"_Y3Itb_media-popover-image-view-active_2lj7U",void 0,"._Y3Itb_media-popover-image-view-active_2lj7U"),h(F.MainMedia,void 0,"_Y3Itb_media-popover-image-view-active_2lj7U",'div[data-mediaid="'+u+'"]'));qb(a,u)},updateSingleReviewContent:function(u){var t=pb(a,F.SingleReviewComponent);t&&t.firstChild&&t.replaceChild(u,t.firstChild)}}},rb=function(a,b){if(!a)return!1;
b=b.some(function(c){return a.classList.contains(c)});return a.offsetHeight<a.scrollHeight&&b},Xc=function(a){var b=["_Y3Itb_cr-sidepanel-truncated-text_3nfmo","_Y3Itb_cr-sidepanel-truncated-title_2w0Qj"],c=R(a,"_Y3Itb_cr-media-popover-sidepanel-header-section_3TxI7"),d=R(c,"_Y3Itb_cr-sidepanel-text_3MYCz"),e=R(c,"_Y3Itb_cr-sidepanel-title_EX93d"),f=R(c,"_Y3Itb_cr-sidepanel-expander-see-more_1sipE"),h=R(c,"_Y3Itb_cr-sidepanel-expander-see-less_1Hpji"),k=R(c,"_Y3Itb_cr-sidepanel-container-gradient_1zm2j"),
m=function(p){rb(p,b)&&(z(f,function(D){return O(D)}),z(k,function(D){return Ub("_Y3Itb_cr-sidepanel-container-gradient-truncated_3zXR9",D)}))},r=new ResizeObserver(function(p){var D;try{for(var u=g.__values(p),t=u.next();!t.done;t=u.next())m(t.value.target)}catch(A){var y={error:A}}finally{try{t&&!t.done&&(D=u.return)&&D.call(u)}finally{if(y)throw y.error;}}});z(d,function(p){r.observe(oa.unscope(p))});z(e,function(p){r.observe(oa.unscope(p))});var n=function(){l(!0);z(f,function(p){return L(p)});
z(h,function(p){return O(p)})},w=function(){l(!1);z(h,function(p){return L(p)})},l=function(p){q("_Y3Itb_cr-media-popover-sidepanel-header-section-truncated_DITiq",p,c);q("_Y3Itb_cr-sidepanel-container-gradient-truncated_3zXR9",p,k);q("_Y3Itb_cr-sidepanel-truncated-text_3nfmo",p,d);q("_Y3Itb_cr-sidepanel-truncated-title_2w0Qj",p,e)},q=function(p,D,u){D?z(u,function(t){return Tb(p,t)}):z(u,function(t){return Ub(p,t)})};return{toggleText:function(){d&&rb(d,b)||e&&rb(e,b)?n():w()},hideText:w,expandText:n,
initialize:function(){z(f,function(p){return L(p)});z(k,function(p){return Tb("_Y3Itb_cr-sidepanel-container-gradient-truncated_3zXR9",p)});m(d);m(e)}}},sb=function(){function a(b){this.actionButtons=b}a.getActionButtonsContainer=function(b){var c=Q["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_cr-vote-report-buttons-container_1YjZZ");return Array.from(c).filter(function(d){return d.dataset.id===b})[0]};a.prototype.likeButtonClicked=function(){var b=this.actionButtons.querySelectorAll("div[data-variant='like']")[0],
c=this.actionButtons.querySelectorAll("div[data-variant='like-done']")[0];L(b);O(c)};a.prototype.resetLike=function(){var b=this.actionButtons.querySelectorAll("div[data-variant='like']")[0],c=this.actionButtons.querySelectorAll("div[data-variant='like-done']")[0];L(c);O(b)};return a}(),Yc={dataStrategy:"inline",activate:"onclick",position:"triggerVertical"},Zc=function(a){var b;return{openTooltipPopover:function(c){return g.__awaiter(void 0,void 0,void 0,function(){var d,e,f;return g.__generator(this,
function(h){switch(h.label){case 0:if(b)return[3,2];d="reportAbusePreload_"+a;e=R(c,"_Y3Itb_cr-report-abuse-preload-content_ve26F");null===e||void 0===e?void 0:e.classList.remove("aok-hidden");f=g.__assign(g.__assign({},Yc),{name:d,content:e});return e?[4,Uc.get(d,e,c,f)]:[3,2];case 1:b=h.sent(),h.label=2;case 2:return b&&b.show(),[2]}})})},closeTooltipPopover:function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(c){b&&b.hide();return[2]})})},isOpen:function(){return b?
b.isOpen():!1}}},$c=function(a){var b=(a=R(a,"_Y3Itb_cr-vote-report-buttons-container_1YjZZ"))?new sb(a):void 0,c=new Set;return{initialize:function(d){c.has(d)?null===b||void 0===b?void 0:b.likeButtonClicked():null===b||void 0===b?void 0:b.resetLike()},addReviewId:function(d){null===b||void 0===b?void 0:b.likeButtonClicked();c.add(d)}}},ad=function(a,b){var c=R(a,"_Y3Itb_left-icon-container_31i2O"),d=R(a,"_Y3Itb_right-icon-container_3Qopb");return{initialize:function(e,f){z(c,O);z(d,O);b.isFirstMediaItem(e,
f)&&z(c,L);b.isLastMediaItem(e,f)&&z(d,L)},hideButtons:function(){z(c,L);z(d,L)}}},bd=function(a,b,c){a=R(a,"_Y3Itb_modal-content-container_XXRsT");var d=R(a,"_Y3Itb_cr-action-buttons-container_3vmwq"),e=ad(a,b),f=Zc(c);if(!a)throw Error("modalContent element was not found");return{reportAbuse:g.__assign({},f),helpfulVote:g.__assign({},$c(a)),navigation:g.__assign({},e),toggleMediaButtonsVisibility:function(h,k,m){if(h){if(!k||!m)throw Error("reviewId or mediaId not found: "+k+", "+m);z(d,O);e.initialize(k,
m)}else f.isOpen()||(z(d,L),e.hideButtons())}}},xa=function(){function a(b,c){var d;this.toastBar=c?a.getToastBarByNameIn(b,c):a.getToastBarByName(b);this.button=null===(d=this.toastBar)||void 0===d?void 0:d.getElementsByClassName("_Y3Itb_toast-bar-button_1yIpW")[0]}a.getToastBarByName=function(b){return Q["default"].cardRoot.ownerDocument.querySelector("div[data-toast-bar-name='"+b+"']")};a.getToastBarByNameIn=function(b,c){return Va(c,"div[data-toast-bar-name='"+b+"']")};a.prototype.setClickParams=
function(b){var c=this;b.forEach(function(d,e){var f;null===(f=c.button)||void 0===f?void 0:f.setAttribute(e,d)})};a.prototype.show=function(){z(this.toastBar,O)};a.prototype.hide=function(){z(this.toastBar,L)};return a}(),ed=function(a,b,c,d){setTimeout(function(){var e=d.parentElement,f=null===e||void 0===e?void 0:e.parentElement;if(e=null===f||void 0===f?void 0:f.offsetHeight){var h=d.offsetHeight;h=(f=null===f||void 0===f?void 0:f.querySelector('[data-reviewbind="ImageThumbnailsBlock"]'))?Math.max(e-
h+100-f.offsetHeight-8-22,100):Math.max(e-h+100-88-22,100)}else h=100;e=cd(a,b,h);if((f=a.querySelector(".a-cardui-body .a-reactive-container"))&&f.scrollHeight>=h){f.style.height=h+"px";h=b.querySelector(".a-expander-icon");if(f=b.querySelector(".a-see-more-text")){f.style.display="none";a.setAttribute("data-a-expanded","false");if(c){var k=c.querySelector(".a-reactive-container");k&&(k.className="a-reactive-container a-reactive-container-transition")}b.style.opacity="1";b.style.display="block";
f.style.display="inline";h&&(h=h.querySelector(".a-css-icon"))&&(h.className="a-css-icon a-css-icon-draw a-css-icon-expand")}dd(a,b,e)}else a.setAttribute("data-a-expanded","true"),b&&b.remove(),f&&(e=f.querySelector(".a-reactive-container-gradient"))&&e.remove()},0)},cd=function(a,b,c){return function(d){var e=a.querySelector(".a-cardui-body .a-reactive-container");e&&(e.style.transition="height 200ms linear",e.style.height=d?e.scrollHeight+"px":c+"px");a.setAttribute("data-a-expanded",d?"true":
"false");if(e=b.querySelector(".a-css-icon"))e.className=d?"a-css-icon a-css-icon-draw a-css-icon-collapse":"a-css-icon a-css-icon-draw a-css-icon-expand";e=b.querySelector(".a-see-more-text");var f=b.querySelector(".a-see-less-text");e&&f&&(e.style.display=d?"none":"inline",f.style.display=d?"inline":"none")}},dd=function(a,b,c){(b=b.querySelector(".a-cardui-expand-control-footer-button"))&&b.addEventListener("click",function(){var d="true"===a.getAttribute("data-a-expanded");c(!d)})},gd=function(a,
b,c,d){var e=Wc(b,a),f=Xc(b),h=bd(b,c,a),k=new xa(N.THANKYOU_MESSAGE_TOAST_BAR_NAME,b),m=new xa(N.ERROR_MESSAGE_TOAST_BAR_NAME,b),r=ia["default"].setup(["reportAbuse"]),n=ia["default"].setup(["helpful"]),w=ia["default"].setup(["renderSingleReview"]),l={},q=new Map,p=function(C,v){z(C,function(B){l.reviewId=B});z(v,function(B){l.mediaId=B})},D=function(C,v){C=v[C];return a===H.IMAGE?C.image.physicalId:C.video.physicalId},u=function(C){return C.map(function(v){return v.mediaType===H.IMAGE?v.image:v.video}).findIndex(function(v){return(null===
v||void 0===v?void 0:v.physicalId)===l.mediaId})},t=function(){return g.__awaiter(void 0,void 0,void 0,function(){var C;return g.__generator(this,function(v){switch(v.label){case 0:if(!l.reviewId||!l.mediaId)throw Error("No reviewId present: "+l);return[4,c.fetchNextReview(l.reviewId)];case 1:return(C=v.sent())?[4,y(D(0,C.mediaGroup.mediaList),C.mediaGroup.id)]:[3,3];case 2:v.sent(),v.label=3;case 3:return[2]}})})},y=function(C,v){return g.__awaiter(void 0,void 0,void 0,function(){var B,E;return g.__generator(this,
function(V){switch(V.label){case 0:return[4,c.fetchReview(v)];case 1:B=V.sent();if(!B)throw Error("review was not fetched: "+v);E={reviewId:v,mediaId:C,reviewRank:B.reviewRank,mediaGroup:B.mediaGroup};return d?[4,A(B)]:[3,3];case 2:return V.sent(),e.updateReviewMedia(E),[3,4];case 3:e.updateReview(E),V.label=4;case 4:return p(v,C),f.hideText(),f.initialize(),h.helpfulVote.initialize(v),h.navigation.initialize(v,C),[2]}})})},A=function(C){return g.__awaiter(void 0,void 0,void 0,function(){var v,B,
E,V,ba,Aa,tb;return g.__generator(this,function(ub){switch(ub.label){case 0:return v=b.querySelector("div[data-reviewid]"),B=null===(tb=null===(Aa=C.mediaGroup.mediaList.at(0))||void 0===Aa?void 0:Aa.metadata)||void 0===tb?void 0:tb.review,E={isMshop:"true"===v.dataset.ismshop,locale:v.dataset.locale||"",marketplaceId:v.dataset.marketplaceid||"",isKindleApp:"true"===v.dataset.iskindleapp,localeLanguageName:v.dataset.localelanguagename||void 0,csrfT:v.dataset.csrft||"",isCustomerRecognized:"true"===
v.dataset.iscustomerrecognized,isAndroidApp:"true"===v.dataset.isandroidapp,isIosApp:"true"===v.dataset.isiosapp,isMobile:!1,lazyLoading:!1,isSingleReviewFromSharedLibraryEnabled:!0,imageProfileLazyLoading:!1,isModalView:!0},B&&E?[4,x(B,E)]:[3,2];case 1:V=ub.sent();var Wa=V;if(Wa){var Ba=Wa.querySelector('[data-a-card-type="peekExpand"]');if(Ba){var fd=Ba.querySelector(".a-cardui-body"),Yb=Ba.querySelector(".a-cardui-expand-control-footer"),vb=Ba.querySelector(".a-cardui-footer");Ba.style.marginTop=
"0px";vb&&(vb.style.padding="0px",vb.style.paddingTop="0px");Yb&&ed(Ba,Yb,fd,Wa)}}ba=Wa;ba&&q.set(B.id,ba.cloneNode(!0));e.updateSingleReviewContent(V);ub.label=2;case 2:return[2]}})})},x=function(C,v){return g.__awaiter(void 0,void 0,void 0,function(){var B,E,V,ba;return g.__generator(this,function(Aa){switch(Aa.label){case 0:B=C.id;if(q.has(B))return[2,q.get(B).cloneNode(!0)];E={review:C,requestContext:v};ba=oa.unscope;return[4,w.renderSingleReview(E)];case 1:return V=ba.apply(void 0,[Aa.sent()]),
[2,V]}})})},M=function(C){if(!l.reviewId)throw Error("no reviewId found while updating media: "+l.mediaId);e.updateMedia(C);p(l.reviewId,C);h.navigation.initialize(l.reviewId,C)};return{show:function(){return z(b,O)},hide:function(){return z(b,L)},update:function(C){var v=C.mediaId,B=C.reviewId;return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(E){switch(E.label){case 0:if(!v||!B)throw Error("reviewId or mediaId not found: "+B+", "+v);return[4,y(v,B)];case 1:return E.sent(),
[2]}})})},updateMedia:M,handleModalMediaProgressionClick:function(C){return g.__awaiter(void 0,void 0,void 0,function(){var v,B,E,V;return g.__generator(this,function(ba){switch(ba.label){case 0:if(!l.reviewId||!l.mediaId)throw Error("No reviewId or mediaId present: "+l);v=c.getReviewById(l.reviewId);B=u(v.mediaList);E=C;switch(E){case X.RIGHT:return[3,1];case X.LEFT:return[3,5]}return[3,10];case 1:if(!(B<v.mediaList.length-1))return[3,2];M(D(B+1,v.mediaList));return[3,4];case 2:return[4,t()];case 3:ba.sent(),
ba.label=4;case 4:return[3,10];case 5:if(!(0<B))return[3,6];M(D(B-1,v.mediaList));return[3,9];case 6:return[4,c.fetchPreviousReview(l.reviewId)];case 7:return(V=ba.sent())?[4,y(D(V.mediaGroup.mediaList.length-1,V.mediaGroup.mediaList),V.mediaGroup.id)]:[3,9];case 8:ba.sent(),ba.label=9;case 9:return[3,10];case 10:return[2]}})})},handleExpanderClick:function(C){switch(C){case za.EXPAND:f.expandText();break;case za.HIDE:f.hideText()}},handleReportAbuseClick:function(C){return g.__awaiter(void 0,void 0,
void 0,function(){var v,B;return g.__generator(this,function(E){switch(E.label){case 0:if(!l.reviewId)throw Error("no reviewId found while reporting abuse: "+l);h.reportAbuse.closeTooltipPopover();E.label=1;case 1:return E.trys.push([1,5,,6]),[4,r.reportAbuse({reviewId:l.reviewId,asin:C,domain:Ca()})];case 2:v=E.sent();if(!v.success&&v.redirectUrl)return Z["default"].setLocation(v.redirectUrl),[2];if(!v.success)return[3,4];k.show();return[4,t()];case 3:return E.sent(),[2];case 4:return v.success?
[3,6]:(m.show(),[2]);case 5:throw B=E.sent(),m.show(),B;case 6:return[2]}})})},handleHelpulVoteClick:function(C){return g.__awaiter(void 0,void 0,void 0,function(){var v,B;return g.__generator(this,function(E){switch(E.label){case 0:if(!l.reviewId)throw Error("no reviewId found while handling helpfulvote call: "+l);E.label=1;case 1:return E.trys.push([1,3,,4]),[4,n.helpful({reviewId:l.reviewId,domain:Ca(),asin:C})];case 2:return v=E.sent(),!v.success&&v.redirectUrl&&Z["default"].setLocation(v.redirectUrl),
v.success?(h.helpfulVote.addReviewId(l.reviewId),[2]):v.success?[3,4]:(m.show(),[2]);case 3:throw B=E.sent(),m.show(),B;case 4:return[2]}})})},openReportAbuseTooltip:h.reportAbuse.openTooltipPopover,toggleMediaButtonsVisibility:function(C){h.toggleMediaButtonsVisibility(C,l.reviewId,l.mediaId)},getCurrentReviewDetails:function(){return l},updateReviewDetails:p,renderSingleReviewFromSharedLibrary:A}},hd=J["default"].setup(),id=function(a){var b=0,c=function(k,m,r){var n;return n={},n[N.DATA_MEDIA_ID]=
k,n[N.DATA_MEDIATYPE]=r,n[N.DATA_REVIEW_ID]=m,n[N.DATA_SHOW_GALLERY_IN_MODAL]="false",n},d=function(k){var m;return m={},m[N.DATA_CSA_C_TYPE]="element",m[N.DATA_CSA_SLOT_ID]=k,m},e=function(k){return[{tag:"img",elementAttributes:{src:k.thumbnailUrl,alt:k.altText}}]},f=function(k,m){var r={tag:"img",elementAttributes:{src:k.thumbnailUrl,alt:k.altText}};return m?[r,{tag:"div",elementAttributes:{class:"_Y3Itb_media-gallery-item-video-overlay-container_RHWdX"},children:[{tag:"div",elementAttributes:{class:"_Y3Itb_media-gallery-item-video-overlay_cGzRu"},
children:[{tag:"i",elementAttributes:{"class":"a-icon a-icon-star-mini a-star-mini-"+m.rating}},{tag:"span",textContent:"\u25b7 "+k.videoDuration}]}]}]:[r]},h=function(k,m,r,n,w){return k.map(function(l,q){var p,D=l.mediaType==fb.IMAGE?l.image:l.video;if(D){var u=l.mediaType==fb.IMAGE?e(l.image):f(l.video,l.metadata),t=null===(p=l.metadata)||void 0===p?void 0:p.contributionId;if(t)return{tag:"button",elementAttributes:g.__assign(g.__assign({class:l.mediaType==fb.IMAGE?"_Y3Itb_media-gallery-item_3LROo":
"_Y3Itb_media-gallery-item-video_1k9yY"},c(D.physicalId,t,l.mediaType)),d(w+"_"+t+"_"+D.physicalId+"_"+n)),observer:q==m?r:void 0,children:g.__spread(u),clickHandler:function(y){return hd.attach(Y.galleryItemClickHandler,y)}}}}).filter(function(l){return void 0!==l})};return{updateGallery:function(k,m,r,n){k=h(k,m,r,b,n);b++;0<k.length&&Xb(a,{type:U.APPEND_ELEMENT,key:F.GalleryBlock,elements:k})}}},jd=function(a,b,c){var d=R(b,"_Y3Itb_media-popover-gallery-container-grid_mLjpJ"),e=R(b,"_Y3Itb_gallery-spinner_34BcK"),
f=a===H.IMAGE?"cm_cr_image_gallery_popover":"cm_cr_video_gallery_popover",h=new IntersectionObserver(function(n,w){n.forEach(function(l){return g.__awaiter(void 0,void 0,void 0,function(){var q;return g.__generator(this,function(p){switch(p.label){case 0:if(!l.isIntersecting)return[3,4];p.label=1;case 1:return p.trys.push([1,3,,4]),z(e,O),[4,c.fetchReviewsNextPage()];case 2:return p.sent(),r(),z(e,L),w.unobserve(l.target),[3,4];case 3:throw q=p.sent(),q;case 4:return[2]}})})})},{root:oa.unscope(d),
rootMargin:"0px",threshold:.25}),k=id(d),m=0,r=function(){for(var n=c.getAllReviews(),w=c.getAllReviewIds(),l=[],q=m;q<w.length;q++)l.push.apply(l,g.__spread(n[w[q]].mediaList)),m++;k.updateGallery(l,5<=l.length?l.length-5:-1,h,f)};return{hide:function(){return z(b,L)},show:function(){return z(b,O)},update:function(){return g.__awaiter(void 0,void 0,void 0,function(){var n;return g.__generator(this,function(w){switch(w.label){case 0:return n=c.getAllReviewIds(),0!=n.length?[3,2]:[4,c.fetchReviewsNextPage()];
case 1:w.sent(),w.label=2;case 2:return r(),[2]}})})},scrollToMediaId:function(n){n&&(n=Va(b,'div[data-mediaid="'+n+'"]'),z(n,function(w){return w.scrollIntoView()}))}}},kd=function(a){var b=R(a,"_Y3Itb_media-popover-see-all-container_1Lmmi");return{show:function(){return z(b,function(c){return O(c)})},hide:function(){return z(b,function(c){return L(c)})}}},ld=function(a,b){var c=[],d={},e,f,h=function(){return g.__awaiter(void 0,void 0,void 0,function(){var l,q;return g.__generator(this,function(p){switch(p.label){case 0:return l=
ua.setup(["getGroupedMediaReviews"]),[4,l.getGroupedMediaReviews({asin:a,nextToken:e,mediaType:b,limit:25})];case 1:return q=p.sent(),k(q.mediaGroupList),e=q.nextToken,[2]}})})},k=function(l){l.forEach(function(q){d[q.id]=q;0>c.indexOf(q.id)&&c.push(q.id)})},m=function(l){return!!d[l]},r=function(l){return c.indexOf(l)},n=function(){return g.__awaiter(void 0,void 0,void 0,function(){var l;return g.__generator(this,function(q){switch(q.label){case 0:l=0===Object.keys(d).length;if(!l&&(l||f||!e))return[3,
5];q.label=1;case 1:return q.trys.push([1,,3,4]),[4,h()];case 2:return q.sent(),[3,4];case 3:return f=!1,[7];case 4:return[2,!0];case 5:return[2,!1]}})})},w=function(l,q){return d[l].mediaList.map(function(p){return p.mediaType===H.IMAGE?p.image:p.video}).findIndex(function(p){return(null===p||void 0===p?void 0:p.physicalId)===q})};return{fetchReview:function(l){return g.__awaiter(void 0,void 0,void 0,function(){var q,p,D,u;return g.__generator(this,function(t){switch(t.label){case 0:if(!l)throw Error("fetchReview was called without a reviewId");
q=m(l);t.label=1;case 1:return q?[3,3]:[4,n()];case 2:return p=t.sent(),q=m(l),p?[3,1]:[3,3];case 3:if(m(l))return[3,5];D=ua.setup(["getMediaGroup"]);return[4,D.getMediaGroup({reviewId:l})];case 4:u=t.sent(),k(u),e="",G.logCounter("desktop.missingReviewId",1),t.label=5;case 5:return m(l)?[2,{mediaGroup:d[l],reviewRank:r(l)}]:[2]}})})},isReviewFetched:m,fetchReviewsNextPage:n,fetchNextReview:function(l){return g.__awaiter(void 0,void 0,void 0,function(){var q,p;return g.__generator(this,function(D){switch(D.label){case 0:return q=
r(l)+1,q>=c.length?[4,n()]:[3,2];case 1:D.sent(),D.label=2;case 2:return p=c[q],m(p)?[2,{mediaGroup:d[p],reviewRank:q}]:[2]}})})},fetchPreviousReview:function(l){return g.__awaiter(void 0,void 0,void 0,function(){var q,p;return g.__generator(this,function(D){q=r(l)-1;if(0>q)return[2];p=c[q];return m(p)?[2,{mediaGroup:d[p],reviewRank:q}]:[2]})})},getReviewById:function(l){return d[l]},getReviewIndexById:r,getAllReviews:function(){return d},getAllReviewIds:function(){return c},isFirstMediaItem:function(l,
q){var p=r(l);l=w(l,q);return 0===p&&0===l},isLastMediaItem:function(l,q){var p=r(l);q=w(l,q);return!e&&p===c.length-1&&q===d[l].mediaList.length-1}}},Ia=function(){var a={};return{setData:function(b,c){a[b]=c},getData:function(b){return a[b]},hasData:function(b){return b in a},removeData:function(b){delete a[b]},clearData:function(){for(var b in a)a.hasOwnProperty(b)&&delete a[b]}}}(),md=function(a,b,c,d,e){var f=ld(b,c),h=Vc(d),k=kd(d),m=new xa(N.LOADPOPOVER_ERROR_TOAST_BAR_NAME,d),r=R(d,"_Y3Itb_single-review-media-popover-container_1h9X2");
if(!r)throw Error("Unable to find singleReviewMediaPopoverContainer");var n=gd(c,r,f,e);d=R(d,"_Y3Itb_gallery-container_2pBFm");if(!d)throw Error("Unable to find mediaGalleryContainer");var w=jd(c,d,f);return{loadModal:function(l){return g.__awaiter(void 0,void 0,void 0,function(){var q;return g.__generator(this,function(p){switch(p.label){case 0:return m.hide(),n.hide(),w.hide(),h.show(),h.setLoadingAnimation(!0),l.popoverDetails.popover?[4,l.popoverDetails.popover.showSync()]:[3,2];case 1:p.sent(),
p.label=2;case 2:return p.trys.push([2,4,,5]),q=l.showGalleryInModal?w:n,[4,q.update(l)];case 3:return p.sent(),q.show(),l.showGalleryInModal?k.hide():k.show(),h.hide(),[3,5];case 4:p.sent();G.logCounter("desktop.popoverLoading.Error",1);h.setLoadingAnimation(!1);if(!l.mediaType||!l.asin)throw Error("mediaType or asin was not found while setting parameters for toastbar: "+l.mediaType+", "+l.asin);p=new Map([[N.DATA_POPOVER_NAME,l.popoverDetails.popoverName],[N.DATA_ASIN,l.asin],[N.DATA_MEDIATYPE,
l.mediaType.toString()]]);if(l.showGalleryInModal)p.set(N.DATA_SHOW_GALLERY_IN_MODAL,"true");else{if(!l.reviewId||!l.mediaId)throw Error("mediaId or reviewId was not found while setting parameters for toastbar: "+l.reviewId+", "+l.mediaId);p.set(N.DATA_REVIEW_ID,l.reviewId);p.set(N.DATA_MEDIA_ID,l.mediaId)}m.setClickParams(p);m.show();return[3,5];case 5:return[2]}})})},updateModalWithReview:function(l,q){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(p){switch(p.label){case 0:return w.hide(),
k.show(),[4,n.update({reviewId:l,mediaId:q,asin:b,mediaType:c})];case 1:return p.sent(),n.show(),[2]}})})},showMediaGallery:function(){return g.__awaiter(void 0,void 0,void 0,function(){var l;return g.__generator(this,function(q){switch(q.label){case 0:return l=n.getCurrentReviewDetails().mediaId,n.hide(),k.hide(),h.show(),h.setLoadingAnimation(!0),[4,w.update()];case 1:return q.sent(),h.hide(),w.show(),w.scrollToMediaId(l),[2]}})})},updateMediaInModal:n.updateMedia,handleModalMediaProgressionClick:n.handleModalMediaProgressionClick,
handleExpanderClick:n.handleExpanderClick,openReportAbuseDialog:n.openReportAbuseTooltip,handleReportAbuseClick:function(){return n.handleReportAbuseClick(b)},handleHelpulVoteClick:function(){return n.handleHelpulVoteClick(b)},closeModal:function(){return Ga.getPopoverByName(a).hide()}}},Zb=function(a,b){return g.__awaiter(void 0,void 0,void 0,function(){var c;return g.__generator(this,function(d){switch(d.label){case 0:return c=ia["default"].setup(["triggerWeblab"]),[4,c.triggerWeblab({weblabId:a,
isCustomerIdBasedWeblab:b})];case 1:return[2,d.sent()]}})})},nd=function(){function a(){this.desktopPopoverModalOptions={dataStrategy:"preload",hideHeader:!0,closeButton:!0,padding:"none",name:"cr-media-popover"}}a.prototype.onVideoClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){throw Error("Video click handler on Desktop is not yet implemented.");})})};a.prototype.onImageClickHandler=function(b){return g.__awaiter(this,void 0,void 0,
function(){return g.__generator(this,function(c){switch(c.label){case 0:return[4,this.showImagePopover(b,!1)];case 1:return c.sent(),[2]}})})};a.prototype.onSeeMoreClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f;return g.__generator(this,function(h){switch(h.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=H[d.mediatype],f=Ya(e),f!==ha.IMAGE?[3,2]:[4,this.showImagePopover(b,!0)];case 1:return h.sent(),[3,3];case 2:throw G.logError("loadDesktopVideoGalleryError",
f),Error("Video gallery is not available on desktop.");case 3:return[2]}})})};a.prototype.showImagePopover=function(b,c){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(d){switch(d.label){case 0:return[4,this.openModal(b,c)];case 1:return d.sent(),[2]}})})};a.prototype.openModal=function(b,c){return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h,k,m,r,n,w,l,q,p,D,u,t,y;return g.__generator(this,function(A){switch(A.label){case 0:d=b.currentTarget;e=Sb(d);
if(c&&(!e.mediaType||!e.asin))throw Error("media props are missing while trying to load the modal: "+JSON.stringify(e));if(!(c||e.mediaType&&e.asin&&e.reviewId&&e.mediaId))throw Error("media props are missing while trying to load the modal: "+JSON.stringify(e));f=e.mediaType===H.IMAGE?"_Y3Itb_cm_cr_image_popoversection_3iYPp":"_Y3Itb_cm_cr_video_popoversection_2v7yY";h=S["default"].cardRoot.getElementsByClassName(f)[0];k=h.getElementsByClassName("_Y3Itb_media-popover-container_2BBbs")[0];m=this.desktopPopoverModalOptions.name+
"_"+e.mediaType;r=h.querySelector("div[data-reviewbind=SingleReviewMediaBlock]");n=(null===r||void 0===r?void 0:r.getAttribute("data-closebuttonaria"))||"";w=(null===r||void 0===r?void 0:r.getAttribute("data-modaltitlearia"))||"";q=l=!1;if(!k)return[3,2];(p=k.querySelector("div[data-reviewid]"))&&(q="true"===p.dataset.iscustomerrecognized);return q?[4,Zb("COFEE_DD_MEDIA_CARDS_MIGRATION_SHARED_LIBRARY_1247512")]:[3,2];case 1:D=A.sent(),"T1"===D.treatment&&(l=!0),A.label=2;case 2:return u=g.__assign(g.__assign({},
this.desktopPopoverModalOptions),{name:m,closeButtonLabel:n,popoverLabel:w}),[4,Tc.get(m,k,d,u)];case 3:t=A.sent();y=Ia.hasData(e.mediaType)?Ia.getData(e.mediaType):md(m,e.asin,e.mediaType,k,l);if(!y)throw Error("Could not load ModalManager for opening modal: "+e);return[4,y.loadModal({asin:e.asin,mediaId:e.mediaId,reviewId:e.reviewId,mediaType:e.mediaType,showGalleryInModal:c,popoverDetails:{popoverName:this.desktopPopoverModalOptions.name+"_"+e.mediaType,popover:t}})];case 4:return A.sent(),Ia.hasData(e.mediaType)||
Ia.setData(e.mediaType,y),t.updatePosition(),d.classList.remove("a-declarative"),[2]}})})};return a}(),Za=function(a,b){a=b?a+". Error object: "+JSON.stringify({message:b.message,name:b.name,stack:b.stack}):a;T.log(a,"FATAL")},ka;(function(a){a.CAROUSEL="crsl";a.IMAGES_CAROUSEL="crsl_img";a.VIDEOS_CAROUSEL="crsl_vid";a.MIXED_CAROUSEL="crsl_mixed"})(ka||(ka={}));var la;(function(a){a.DETAIL_PAGE_WIDGET="dp";a.IMAGE_GALLERY="img";a.MEDIA_GALLERY="mg";a.OTHER="othr"})(la||(la={}));var ma;(function(a){a.SEE_MORE=
"sm";a.POPOVER="pop";a.IMAGE="img";a.VIDEO="vid"})(ma||(ma={}));var na;(function(a){a.DESKTOP="d";a.MOBILE_APP="ma";a.MOBILE_BROWSER="mb";a.TABLET_APP="ta";a.TABLET_BROWSER="tb";a.UNKNOWN="unkn"})(na||(na={}));var ya=function(){function a(b,c,d,e){this.page=b;this.device=c;this.widget=d;this.location=e}a.prototype.toString=function(){return a.PREFIX+a.DELIMITER+this.page+a.DELIMITER+this.device+a.DELIMITER+this.widget+a.DELIMITER+this.location};a.prototype.appendToString=function(b){return b?this.toString()+
a.DELIMITER+b:this.toString()};a.MAX_LENGTH=32;a.PREFIX="cm_cr";a.DELIMITER="_";return a}(),od=new ya(la.DETAIL_PAGE_WIDGET,na.MOBILE_APP,ka.CAROUSEL,ma.IMAGE),pd=new ya(la.DETAIL_PAGE_WIDGET,na.MOBILE_APP,ka.CAROUSEL,ma.VIDEO),qd=new ya(la.DETAIL_PAGE_WIDGET,na.MOBILE_APP,ka.IMAGES_CAROUSEL,ma.SEE_MORE),rd=new ya(la.DETAIL_PAGE_WIDGET,na.MOBILE_APP,ka.VIDEOS_CAROUSEL,ma.SEE_MORE),sd=new ya(la.DETAIL_PAGE_WIDGET,na.MOBILE_APP,ka.MIXED_CAROUSEL,ma.SEE_MORE),td=new ya(la.DETAIL_PAGE_WIDGET,na.MOBILE_BROWSER,
ka.IMAGES_CAROUSEL,ma.SEE_MORE),ud=new ya(la.DETAIL_PAGE_WIDGET,na.MOBILE_BROWSER,ka.CAROUSEL,ma.VIDEO),wb;(function(a){a.IMAGE="IMAGE";a.VIDEO="VIDEO";a.BOTH="BOTH";a.MIXED="MIXED"})(wb||(wb={}));var vd=function(){function a(){}a.prototype.onVideoClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){switch(c.label){case 0:return[4,this.onMediaClickHandler(b)];case 1:return c.sent(),[2]}})})};a.prototype.onImageClickHandler=function(b){return g.__awaiter(this,
void 0,void 0,function(){return g.__generator(this,function(c){switch(c.label){case 0:return[4,this.onMediaClickHandler(b)];case 1:return c.sent(),[2]}})})};a.prototype.onSeeMoreClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h;return g.__generator(this,function(k){switch(k.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=H[d.mediatype],f=d.carouseltype,h=f===wb.MIXED?ha.MIXED:Ya(e),[4,this.goToGallery(b,h)];case 1:return k.sent(),
[2]}})})};a.prototype.onMediaClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h,k,m,r;return g.__generator(this,function(n){switch(n.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=H[d.mediatype],f=d.rank,h={reviewId:d.reviewid,mediaType:e,url:d.url,thumbnailUrl:d.thumbnailurl,physicalId:d.physicalid,asin:d.asin,isSingleReview:!1,hidePivot:!1,refMarker:a.getIVXRefMarker(e,f),ingressType:"dpreviews",filter:e===H.IMAGE?"image":
"video",metricsPrefix:e===H.IMAGE?"CarouselImageToAppX":"CarouselVideoToAppX",sessionId:d.sid},[4,hb()];case 1:return k=n.sent(),[4,this.getIsAnpReviewsMigrationWeblabEnabled()];case 2:return r=(m=n.sent())?"com.amazon.mshop.ivx.featureClosed":"com.amazon.mshop.ivx1.closed.progressPositionAndMediaIdSend",k.addEventListener(r,function(){this.refocusToMedia(d.physicalId);k.removeEventListener(r)}),m?[4,jc(k,h)]:[3,4];case 3:return n.sent(),[3,6];case 4:return[4,ic(k,h)];case 5:n.sent(),n.label=6;case 6:return[2]}})})};
a.prototype.refocusToMedia=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){return[2,new Promise(function(d,e){var f=Q["default"].cardRoot.ownerDocument.querySelector('button[data-physicalid="'+b+'"]');setTimeout(function(){null===f||void 0===f?void 0:f.focus();d()},0)})]})})};a.prototype.goToGallery=function(b,c){var d;return g.__awaiter(this,void 0,void 0,function(){var e,f,h,k;return g.__generator(this,function(m){switch(m.label){case 0:return e=
null===(d=b.currentTarget)||void 0===d?void 0:d.dataset,f=e.asin,h=c===ha.MIXED?sd:c===ha.IMAGE?qd:rd,[4,hb()];case 1:return k=m.sent(),k.navigate({url:Cb(h.toString(),c,f),successCallback:function(){G.logNoError("loadMediaGalleryError",c)},failCallback:function(r){Za("Failed to load gallery for asin: "+f+".",r);G.logError("loadMediaGalleryError",c)}}),[2]}})})};a.getIVXRefMarker=function(b,c){return(b===H.IMAGE?od:pd).appendToString(c)};a.prototype.getIsAnpReviewsMigrationWeblabEnabled=function(){return g.__awaiter(this,
void 0,void 0,function(){var b,c;return g.__generator(this,function(d){switch(d.label){case 0:return b="",[4,Kc()];case 1:if(!d.sent())return[3,2];b="IVX_ANP_REVIEWS_MEDIA_BETA_1336454";return[3,6];case 2:return[4,Lc()];case 3:if(!d.sent())return[3,4];b="IVX_ANP_REVIEWS_MEDIA_IOS_1336465";return[3,6];case 4:return[4,Mc()];case 5:if(d.sent())b="IVX_ANP_REVIEWS_MEDIA_ANDROID_1336466";else return[2,!1];d.label=6;case 6:return[4,Zb(b,!0)];case 7:return c=d.sent(),[2,"T1"===c.treatment]}})})};return a}(),
W=function(){function a(b){var c=this;this.popover=b;this.loadMediaResources=function(){for(var d=c.popover.querySelectorAll("[data-lazyimagesource]"),e=0;e<d.length;e++){var f=d[e],h=f.getAttribute("data-lazyimagesource");f="img"===f.tagName.toLowerCase()?f:f.getElementsByTagName("img")[0];f.getAttribute("src")!=h&&f.setAttribute("src",h)}};this.getCurrentMediaIndex=function(){for(var d=c.popover.querySelectorAll("[data-mediaid]"),e=0;e<d.length;e++)if("none"!==d[e].style.display)return e;return 0};
this.getPreviousPopoverWidget=function(){return c.popover.previousElementSibling?new a(c.popover.previousElementSibling):null};this.getNextPopoverWidget=function(){return c.popover.nextElementSibling?new a(c.popover.nextElementSibling):null};this.getNumbersOfMedia=function(){return c.popover.querySelectorAll("[data-mediaid]").length};this.toggleOverlay=function(){var d=c.popover.getElementsByClassName("_Y3Itb_overlay-content-container_1ubFP")[0];d.classList.contains("_Y3Itb_media-popover-overlay-fade-out_1eneO")?
(d.classList.remove("_Y3Itb_media-popover-overlay-fade-out_1eneO"),d.classList.add("_Y3Itb_media-popover-overlay-fade-in_bZzwP")):(d.classList.add("_Y3Itb_media-popover-overlay-fade-out_1eneO"),d.classList.remove("_Y3Itb_media-popover-overlay-fade-in_bZzwP"))};this.scrollIntoSelf=function(){c.popover.scrollIntoView()};this.scrollIntoMediaByIndex=function(d){c.scrollIntoSelf();var e=!1;c.popover.querySelectorAll("[data-mediaid]").forEach(function(f,h){e?c.removeHighlightPageIndicator(h):c.addHighlightPageIndicator(h);
h==d?(O(f),e=!0):L(f)})};this.scrollIntoMediaId=function(d){c.scrollIntoSelf();c.popover.querySelectorAll("[data-mediaid]").forEach(function(e,f){e.getAttribute("data-mediaid")===d&&c.scrollIntoMediaByIndex(f)})};this.getReviewId=function(){return c.popover.getAttribute("data-reviewid")};this.getPageIndicator=function(d){var e=c.popover.getElementsByClassName("_Y3Itb_media-popover-page-indicator_36NFP")[0];if(e)return e.childNodes[d]};this.addHighlightPageIndicator=function(d){d=c.getPageIndicator(d);
null===d||void 0===d?void 0:d.classList.add("_Y3Itb_highlighted_1QxVg")};this.removeHighlightPageIndicator=function(d){d=c.getPageIndicator(d);null===d||void 0===d?void 0:d.classList.remove("_Y3Itb_highlighted_1QxVg")}}a.getPopoverWidgetById=function(b){return b?Q["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_media-popover-list-container_3mcnh")[0].querySelector("div[data-reviewid='"+b+"']"):null};a.prototype.handlePopoverClick=function(b){switch(b){case X.LEFT:if(0<this.getCurrentMediaIndex())this.scrollIntoMediaByIndex(this.getCurrentMediaIndex()-
1);else if(b=this.getPreviousPopoverWidget())b.scrollIntoSelf(),b.scrollIntoMediaByIndex(b.getNumbersOfMedia()-1);break;case X.CENTER:this.toggleOverlay();break;case X.RIGHT:if(this.getCurrentMediaIndex()<this.getNumbersOfMedia()-1)this.scrollIntoMediaByIndex(this.getCurrentMediaIndex()+1);else if(b=this.getNextPopoverWidget())b.scrollIntoSelf(),b.scrollIntoMediaByIndex(0)}};a.prototype.scrollIntoNextPopover=function(){var b=this.getNextPopoverWidget()||this.getPreviousPopoverWidget();b&&b.scrollIntoSelf()};
return a}(),ea;(function(a){a.closePopoverClickHandler="ClosePopoverClickHandler";a.popoverClickHandler="PopoverClickHandler";a.desktopLeftClickHandler="DesktopLeftClickHandler";a.desktopRightClickHandler="DesktopRightClickHandler";a.openReportConfirmationDialogClickHandler="OpenReportConfirmationDialogClickHandler";a.helpfulVoteClickHandler="HelpfulVoteClickHandler";a.confirmReportAbuseClickHandler="ConfirmReportAbuseClickHandler";a.noopHandler="noopHandler";a.loadMediaPopover="loadMediaPopover";
a.closePopoverErrorDialogClickHandler="ClosePopoverErrorDialogClickHandler"})(ea||(ea={}));var wd=function(){function a(b){this.popover=b;b=b.getElementsByClassName("_Y3Itb_cr-popover-overlay-text-container_NfghQ")[0];this.text=b.querySelector("._Y3Itb_cr-text_28H9k");this.title=b.querySelector("._Y3Itb_cr-title_3bWqW");this.expandButton=b.querySelector("._Y3Itb_cr-text-expand-button_2BWKW");this.hideButton=b.querySelector("._Y3Itb_cr-text-hide-button_2qNi2")}a.prototype.toggleElementExpansion=function(b,
c){c?(b.classList.remove("_Y3Itb_truncated_j_-Jw"),b.classList.add("_Y3Itb_expanded_2wQ4c")):(b.classList.remove("_Y3Itb_expanded_2wQ4c"),b.classList.add("_Y3Itb_truncated_j_-Jw"))};a.prototype.initResizeObserver=function(){var b=this;if(this.title||this.text)this.observer=new ResizeObserver(function(c){var d;try{for(var e=g.__values(c),f=e.next();!f.done;f=e.next())a.isTruncated(f.value.target,"_Y3Itb_truncated_j_-Jw")&&O(b.expandButton)}catch(k){var h={error:k}}finally{try{f&&!f.done&&(d=e.return)&&
d.call(e)}finally{if(h)throw h.error;}}}),this.title&&this.observer.observe(this.title),this.text&&this.observer.observe(this.text)};a.prototype.expandText=function(){this.text&&a.isTruncated(this.text,"_Y3Itb_truncated_j_-Jw")&&this.toggleElementExpansion(this.text,!0);this.title&&a.isTruncated(this.title,"_Y3Itb_truncated_j_-Jw")&&this.title.classList.remove("_Y3Itb_truncated_j_-Jw");L(this.expandButton);O(this.hideButton);this.setPopoverOverlayGradient(!0);this.showActionButtons(!1)};a.prototype.toggleText=
function(){this.text&&a.isTruncated(this.text,"_Y3Itb_truncated_j_-Jw")||this.title&&a.isTruncated(this.title,"_Y3Itb_truncated_j_-Jw")?this.expandText():this.hideText()};a.prototype.hideText=function(){this.text&&(this.text.offsetHeight<this.text.scrollHeight&&(this.text.scrollTop=0),this.toggleElementExpansion(this.text,!1));this.title&&this.title.classList.add("_Y3Itb_truncated_j_-Jw");L(this.hideButton);this.setPopoverOverlayGradient(!1);this.showActionButtons(!0)};a.prototype.setPopoverOverlayGradient=
function(b){var c=this.popover.getElementsByClassName("_Y3Itb_cr-media-popover-overlay-container_32qUq")[0];c&&(b?(c.classList.add("_Y3Itb_popover-overlay-gradient_114MI"),c.dataset.mixOperations=ea.noopHandler):c.classList.contains("_Y3Itb_popover-overlay-gradient_114MI")&&(c.classList.remove("_Y3Itb_popover-overlay-gradient_114MI"),c.dataset.mixOperations&&delete c.dataset.mixOperations))};a.prototype.showActionButtons=function(b){var c=this.popover.getElementsByClassName("_Y3Itb_cr-action-buttons-container_28a_m")[0];
c&&(b?O(c):L(c))};a.isTruncated=function(b,c){return b&&b.offsetHeight<b.scrollHeight&&b.classList.contains(c)};return a}(),xb=function(a){if(a)return(null===a||void 0===a?0:a.getElementsByClassName("_Y3Itb_cr-popover-overlay-text-container_NfghQ")[0])?new wd(a):void 0},xd=function(){return function(){var a=this;this.show=function(){O(a.popoverList)};this.hide=function(){L(a.popoverList)};this.getNumberOfPopoversLoaded=function(){return a.popoverList.childNodes.length};this.getNumberOfPopoversLeft=
function(){if(a.currentReviewId){var b=0;a.popoverList.childNodes.forEach(function(c,d){c.getAttribute("data-reviewid")==a.currentReviewId&&(b=a.getNumberOfPopoversLoaded()-d)});return b}return a.popoverList.childNodes.length};this.addPopovers=function(b){b.querySelectorAll("._Y3Itb_media-popover-container_15D5F").forEach(function(c){c=oa.unscope(c);var d=c.getAttribute("data-reviewid");W.getPopoverWidgetById(d)||(a.popoverList.appendChild(c),a.observer.observe(c),c=xb(W.getPopoverWidgetById(d)),
null===c||void 0===c?void 0:c.initResizeObserver())})};this.scrollTo=function(b,c){a.setCurrentReviewId(b);b=W.getPopoverWidgetById(b);(new W(b)).scrollIntoMediaId(c)};this.setCurrentReviewId=function(b){a.currentReviewId=b};this.doesPopoverExists=function(b){return null!=W.getPopoverWidgetById(b)};this.getNextToken=function(){return a.popoverList.getAttribute("data-next-token")};this.setNextToken=function(b){return a.popoverList.setAttribute("data-next-token",b)};this.setOnScrollCallback=function(b){a.onScrollCallback=
b};this.popoverList=Q["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_media-popover-list-container_3mcnh")[0];this.observer=new IntersectionObserver(function(b){b.forEach(function(c){if(c.isIntersecting){c=new W(c.target);var d=c.getReviewId(),e=a.currentReviewId;a.setCurrentReviewId(d);if(a.onScrollCallback)a.onScrollCallback(d);c.loadMediaResources();c=xb(W.getPopoverWidgetById(e));null===c||void 0===c?void 0:c.hideText()}})},{threshold:.5})}}(),Xa=function(){function a(){this.confirmationDialog=
Q["default"].cardRoot.ownerDocument.querySelector("._Y3Itb_media-popover-report-abuse-confirmation-dialog_7HNIt");this.confirmButton=Q["default"].cardRoot.ownerDocument.querySelector("._Y3Itb_media-popover-report-abuse-confirmation-dialog-button_35f75")}a.prototype.setReviewId=function(b){this.confirmButton.dataset.id=b};a.prototype.setAsin=function(b){this.confirmButton.dataset.asin=b};a.prototype.show=function(){O(this.confirmationDialog)};a.prototype.hide=function(){L(this.confirmationDialog)};
return a}(),$b=function(){function a(){this.popoverSkeleton=Q["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_media-popover-skeleton-container_3DI7n")[0];this.profileSkeleton=this.popoverSkeleton.getElementsByClassName("_Y3Itb_profile-skeleton_1JfdD")[0]}a.prototype.show=function(){O(this.popoverSkeleton)};a.prototype.hide=function(){L(this.popoverSkeleton)};a.prototype.setLoadingAnimation=function(b){b?this.profileSkeleton.classList.add("_Y3Itb_loading_3908t"):this.profileSkeleton.classList.contains("_Y3Itb_loading_3908t")&&
this.profileSkeleton.classList.remove("_Y3Itb_loading_3908t")};return a}(),ta;(function(a){a[a.Popover=0]="Popover";a[a.Gallery=1]="Gallery";a[a.ReportAbuseConfirmationDialog=2]="ReportAbuseConfirmationDialog"})(ta||(ta={}));var Ja=function(){function a(){}a.getInstance=function(){a.instance||(a.instance=new a);return a.instance};a.prototype.initPopoverWidgetList=function(){null==this.popoverWidgetList&&(this.popoverWidgetList=new xd);return this.popoverWidgetList};a.prototype.initPopoverSkeletonClient=
function(){this.popoverSkeleton=new $b};a.prototype.initPopover=function(b){a.currentScreen=ta.Popover;a.popoverName=b;this.resetOverlayComponents();this.initPopoverWidgetList();this.initPopoverSkeletonClient()};a.prototype.loadMediaPopover=function(b){return g.__awaiter(this,void 0,void 0,function(){var c,d,e,f,h,k,m,r=this;return g.__generator(this,function(n){switch(n.label){case 0:return this.initPopover(b.popoverDetails.popoverName),this.popoverSkeleton.show(),this.popoverWidgetList.hide(),this.popoverSkeleton.setLoadingAnimation(!0),
b.popoverDetails.popover?[4,b.popoverDetails.popover.showSync()]:[3,2];case 1:n.sent(),n.label=2;case 2:c=this.popoverWidgetList.doesPopoverExists(b.reviewId),d=0,n.label=3;case 3:n.trys.push([3,9,,10]),n.label=4;case 4:if(c)return[3,6];e=0===d;return[4,this.fetchAnotherPopoversPage(b.asin,b.mediaType,e)];case 5:return f=n.sent(),c=this.popoverWidgetList.doesPopoverExists(b.reviewId),d++,f?[3,4]:[3,6];case 6:if(c)return[3,8];h=ua.setup(["renderPopover"]);return[4,h.renderPopover({reviewId:b.reviewId})];
case 7:k=n.sent(),this.popoverWidgetList.addPopovers(k),this.popoverWidgetList.setNextToken(""),c=!0,G.logCounter("mobileweb.missingReviewId",1),n.label=8;case 8:return this.popoverWidgetList.show(),c&&this.popoverWidgetList.scrollTo(b.reviewId,b.mediaId),this.popoverSkeleton.hide(),[3,10];case 9:return n.sent(),G.logCounter("mobile.popoverLoading.Error",1),this.popoverSkeleton.setLoadingAnimation(!1),m=new xa("loadPopoverError"),m.setClickParams(new Map([["data-popovername",b.popoverDetails.popoverName],
["data-asin",b.asin],["data-mediatype",b.mediaType.toString()],["data-reviewid",b.reviewId],["data-mediaid",b.mediaId]])),m.show(),[3,10];case 10:return this.popoverWidgetList.setOnScrollCallback(function(){5>=r.popoverWidgetList.getNumberOfPopoversLeft()&&r.fetchAnotherPopoversPage(b.asin,b.mediaType)}),[2]}})})};a.prototype.resetOverlayComponents=function(){(new Xa).hide();(new xa("loadPopoverError")).hide();(new xa("reportAbuseThankYouMessage")).hide()};a.prototype.showReportAbuseConfirmationDialog=
function(b,c){a.currentScreen=ta.ReportAbuseConfirmationDialog;var d=new Xa;d.setReviewId(b);d.setAsin(c);d.show()};a.prototype.back=function(){switch(a.currentScreen){case ta.Popover:case ta.Gallery:Ga.getPopoverByName(a.popoverName).hide();break;case ta.ReportAbuseConfirmationDialog:(new Xa).hide(),a.currentScreen=ta.Popover}};a.prototype.fetchAnotherPopoversPage=function(b,c,d){void 0===d&&(d=!1);return g.__awaiter(this,void 0,void 0,function(){var e,f;return g.__generator(this,function(h){switch(h.label){case 0:e=
this.popoverWidgetList.getNumberOfPopoversLoaded();f=this.popoverWidgetList.getNextToken();if(!(d||!this.isAlreadyLoadingMedia&&f&&500>=e))return[3,5];this.isAlreadyLoadingMedia=!0;h.label=1;case 1:return h.trys.push([1,,3,4]),[4,this.loadPopovers(b,c,f)];case 2:return h.sent(),[3,4];case 3:return this.isAlreadyLoadingMedia=!1,[7];case 4:return[2,!0];case 5:return[2,!1]}})})};a.prototype.loadPopovers=function(b,c,d){return g.__awaiter(this,void 0,void 0,function(){var e,f;return g.__generator(this,
function(h){switch(h.label){case 0:return e=ua.setup(["renderPopoverList"]),[4,e.renderPopoverList({asin:b,nextToken:d,mediaType:c,limit:25})];case 1:return f=h.sent(),this.popoverWidgetList.addPopovers(f),d=f.getAttribute("data-next-token"),this.popoverWidgetList.setNextToken(d),[2,d]}})})};return a}().getInstance(),yd=function(){function a(){}a.prototype.onVideoClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h,k,m,r,n,w=this;return g.__generator(this,function(l){d=
null===(c=b.currentTarget)||void 0===c?void 0:c.dataset;e=d.asin;f=d.physicalid;h=d.reviewid;k=d.extension;m=d.thumbnailurl;r=this.getRefMarker(d.rank);Da["default"].trigger("a:declarative:reviews:open-mweb-immersive-video-modal:click",{$event:b.event,$target:b.currentTarget,data:{asin:e,filter:"video",isSingleReview:!0,mediaType:"video",metricsPrefix:"CarouselVideoToAppX",physicalId:f,refMarker:r,reviewId:h,shouldTriggerRefTag:!0,slateImageUrl:m,url:"https://m.media-amazon.com/images/I/"+f+"."+k}});
n=function(){w.refocusToMedia(f);Da["default"].off("vse:ns:partialcomponents:vse_reviews_mobile:lightboxClosed",n)};Da["default"].on("vse:ns:partialcomponents:vse_reviews_mobile:lightboxClosed",n);return[2]})})};a.prototype.refocusToMedia=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){return[2,new Promise(function(d,e){var f=Q["default"].cardRoot.ownerDocument.querySelector('button[data-physicalid="'+b+'"]');setTimeout(function(){null===f||void 0===
f?void 0:f.focus();d()},0)})]})})};a.prototype.getRefMarker=function(b){return ud.appendToString(b)};return a}(),zd=function(){function a(){this.mWebImmersiveVideoClickHandler=new yd}a.prototype.addMinHeightToParent=function(b){(b=Q["default"].cardRoot.ownerDocument.querySelector("."+b))&&b.parentElement&&(b.parentElement.style.minHeight="inherit")};a.prototype.onVideoClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){switch(c.label){case 0:return[4,
this.mWebImmersiveVideoClickHandler.onVideoClickHandler(b)];case 1:return c.sent(),[2]}})})};a.prototype.onImageClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h,k;return g.__generator(this,function(m){switch(m.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=S["default"].cardRoot.getElementsByClassName("_Y3Itb_media-popover-container_2BBbs")[0],f="cr-media-popover",[4,Sc.get(f,e,b.currentTarget)];case 1:return h=m.sent(),k=
H[d.mediatype],[4,Ja.loadMediaPopover({mediaType:k,asin:d.asin,reviewId:d.reviewid,mediaId:d.physicalid,popoverDetails:{popoverName:f,popover:h}})];case 2:return m.sent(),this.addMinHeightToParent("_Y3Itb_media-popover-container_2BBbs"),b.currentTarget&&b.currentTarget.classList.remove("a-declarative"),[2]}})})};a.prototype.onSeeMoreClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h;return g.__generator(this,function(k){d=null===(c=b.currentTarget)||void 0===
c?void 0:c.dataset;e=H[d.mediatype];f=Ya(e);h=d.asin;if(f===ha.IMAGE)Z["default"].setLocation(Cb(td.toString(),ha.IMAGE,h));else throw G.logError("loadVideoGalleryError",f),Error("Video gallery is not available on mWeb.");return[2]})})};return a}(),Ad=function(){function a(){}a.getThumbnailClickHandler=function(){return g.__awaiter(this,void 0,void 0,function(){var b;return g.__generator(this,function(c){switch(c.label){case 0:return[4,Qb()];case 1:b=c.sent();switch(b){case ja.MSHOP:return[2,new vd];
case ja.MWEB:return[2,new zd];case ja.DESKTOP:return[2,new nd]}return[2]}})})};return a}(),Bd=function(){function a(b){this.clickHandler=b}a.prototype.registerThumbnailClickHandlers=function(){this.registerCRVideoThumbnailClickHandler();this.registerCRImageThumbnailClickHandler();this.registerCRSeeMoreThumbnailClickHandler()};a.prototype.registerCRVideoThumbnailClickHandler=function(){var b=this,c=J["default"].setup().define;c(Qc.clickHandler,"click",function(d){return g.__awaiter(b,void 0,void 0,
function(){return g.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.onVideoClickHandler(d)];case 1:return e.sent(),G.logCounter("videoThumbnail.click",1),[2]}})})})};a.prototype.registerCRImageThumbnailClickHandler=function(){var b=this,c=J["default"].setup().define;c(Oc.clickHandler,"click",function(d){return g.__awaiter(b,void 0,void 0,function(){return g.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.onImageClickHandler(d)];case 1:return e.sent(),
G.logCounter("imageThumbnail.click",1),[2]}})})})};a.prototype.registerCRSeeMoreThumbnailClickHandler=function(){var b=this,c=J["default"].setup().define;c(Pc.clickHandler,"click",function(d){return g.__awaiter(b,void 0,void 0,function(){var e,f;return g.__generator(this,function(h){switch(h.label){case 0:return[4,this.clickHandler.onSeeMoreClickHandler(d)];case 1:return h.sent(),e=H[null===(f=d.currentTarget)||void 0===f?void 0:f.dataset.mediatype],G.logCounter("seeMore."+e.toLowerCase()+".click",
1),[2]}})})})};return a}(),yb;(yb||(yb={})).closePopoverClickHandler="ClosePopoverClickHandler";var Cd=function(){function a(){}a.registerClosePopoverClickHandler=function(){var b=J["default"].setup().define;b(yb.closePopoverClickHandler,"click",function(c){c.stopBubble();Ja.back()})};return a}(),Ka;(function(a){a.expandTextClickHandler="expandTextClickHandler";a.hideTextClickHandler="hideTextClickHandler";a.toggleTextClickHandler="toggleTextClickHandler"})(Ka||(Ka={}));var Dd=function(){function a(){}
a.registerTextExpanderClickHandlers=function(){a.registerExpandTextClickHandler();a.registerHideTextClickHandler();a.registerToggleTextClickHandler()};a.registerExpandTextClickHandler=function(){var b=J["default"].setup().define;b(Ka.expandTextClickHandler,"click",function(c){c.stopBubble();c=a.getTextExpanderClient(c);null===c||void 0===c?void 0:c.expandText()})};a.registerHideTextClickHandler=function(){var b=J["default"].setup().define;b(Ka.hideTextClickHandler,"click",function(c){c.stopBubble();
c=a.getTextExpanderClient(c);null===c||void 0===c?void 0:c.hideText()})};a.registerToggleTextClickHandler=function(){var b=J["default"].setup().define;b(Ka.toggleTextClickHandler,"click",function(c){c.stopBubble();c=a.getTextExpanderClient(c);null===c||void 0===c?void 0:c.toggleText()})};a.getTextExpanderClient=function(b){var c;b=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset.reviewid;return xb(W.getPopoverWidgetById(b))};return a}(),ac=function(){function a(){this.errorDialog=Q["default"].cardRoot.ownerDocument.querySelector("._Y3Itb_media-popover-error-dialog_2LoQP")}
a.prototype.show=function(){O(this.errorDialog)};a.prototype.hide=function(){L(this.errorDialog)};return a}(),zb;(zb||(zb={})).closeToastBar="closeToastBarClickHandler";var bc=function(){function a(){}a.registerCloseToastBarClickHandler=function(){var b=J["default"].setup().define;b(zb.closeToastBar,"click",function(c){c.stopBubble();c=c.currentTarget.closest("div[data-toast-bar-name='"+c.currentTarget.dataset.toastBarName+"']");z(c,function(d){return L(d)})})};return a}(),Ed=function(){function a(){}
a.prototype.registerMediaPopoverClickHandlers=function(){Cd.registerClosePopoverClickHandler();this.registerOpenPopoverReportConfirmationDialog();this.registerHelpfulVoteClickHandler();this.registerMediaOverlayClickHandlers();this.registerNoopHandler();this.registerConfirmReportAbuseClickHandler();this.registerClosePopoverErrorDialogClickHandler();this.registerLoadMediaPopoverClickHandler();bc.registerCloseToastBarClickHandler()};a.prototype.registerNoopHandler=function(){var b=J["default"].setup().define;
b(ea.noopHandler,"click",function(c){c.stopBubble()})};a.prototype.registerMediaOverlayClickHandlers=function(){this.registerMediaOverlayNavigationClickHandlers();Dd.registerTextExpanderClickHandlers()};a.prototype.registerClosePopoverErrorDialogClickHandler=function(){var b=J["default"].setup().define;b(ea.closePopoverErrorDialogClickHandler,"click",function(c){c.stopBubble();(new ac).hide()})};a.prototype.registerMediaOverlayNavigationClickHandlers=function(){var b=J["default"].setup().define;b(ea.popoverClickHandler,
"click",function(c){var d=c.event,e=c.currentTarget;var f=d.clientX/e.clientWidth*100;d=d.clientY/e.clientHeight*100;e=(e.clientWidth>e.clientHeight?Ha.LANDSCAPE:Ha.POTRAIT)===Ha.POTRAIT?{lowerBound:33,upperBound:67}:{lowerBound:40,upperBound:80};f=d<=e.lowerBound||d>=e.upperBound?X.NONE:25>=f?X.LEFT:75<=f?X.RIGHT:X.CENTER;(new W(W.getPopoverWidgetById(c.currentTarget.dataset.reviewid))).handlePopoverClick(f)});b(ea.desktopRightClickHandler,"click",function(c){(new W(W.getPopoverWidgetById(c.currentTarget.dataset.reviewid))).handlePopoverClick(X.RIGHT)});
b(ea.desktopLeftClickHandler,"click",function(c){(new W(W.getPopoverWidgetById(c.currentTarget.dataset.reviewid))).handlePopoverClick(X.LEFT)})};a.prototype.registerOpenPopoverReportConfirmationDialog=function(){var b=J["default"].setup().define;b(ea.openReportConfirmationDialogClickHandler,"click",function(c){c.stopBubble();Ja.showReportAbuseConfirmationDialog(c.currentTarget.dataset.id,c.currentTarget.dataset.asin)})};a.prototype.showErrorDialog=function(){(new Xa).hide();(new ac).show()};a.prototype.registerConfirmReportAbuseClickHandler=
function(){var b=this,c=J["default"].setup().define,d=ia["default"].setup(["reportAbuse"]);c(ea.confirmReportAbuseClickHandler,"click",function(e){e.stopBubble();var f=e.currentTarget.firstChild.dataset.id;e=e.currentTarget.firstChild.dataset.asin;d.reportAbuse({reviewId:f,domain:Ca(),asin:e}).then(function(h){!h.success&&h.redirectUrl?Z["default"].setLocation(h.redirectUrl):h.success?(Ja.back(),(new W(W.getPopoverWidgetById(f))).scrollIntoNextPopover(),(new xa("reportAbuseThankYouMessage")).show()):
b.showErrorDialog()})})};a.prototype.registerHelpfulVoteClickHandler=function(){var b=this,c=J["default"].setup().define,d=ia["default"].setup(["helpful"]);c(ea.helpfulVoteClickHandler,"click",function(e){e.stopBubble();var f=e.currentTarget.dataset.id;e=e.currentTarget.dataset.asin;d.helpful({reviewId:f,domain:Ca(),asin:e}).then(function(h){!h.success&&h.redirectUrl?Z["default"].setLocation(h.redirectUrl):h.success?(new sb(sb.getActionButtonsContainer(f))).likeButtonClicked():b.showErrorDialog()})})};
a.prototype.registerLoadMediaPopoverClickHandler=function(){var b=this,c=J["default"].setup().define;c(ea.loadMediaPopover,"click",function(d){return g.__awaiter(b,void 0,void 0,function(){var e,f,h,k;return g.__generator(this,function(m){switch(m.label){case 0:return e=new $b,f=null===(k=d.currentTarget)||void 0===k?void 0:k.dataset,h=H[f.mediatype],e.show(),e.setLoadingAnimation(!0),[4,Ja.loadMediaPopover({asin:f.asin,mediaType:h,reviewId:f.reviewid,mediaId:f.mediaid,popoverDetails:{popoverName:f.popovername},
isDesktop:!Pb()})];case 1:return m.sent(),[2]}})})})};return a}(),ca=J["default"].setup().define,fa=function(a,b){z(a.currentTarget,function(c){var d=Sb(c);if(!d.mediaType)throw Error("unable to extract mediaType from element: "+a.operationName+", "+c.nodeName);var e=Ia.getData(d.mediaType);if(!e)throw Error("unable to get modalManager: "+a.operationName+", "+d);b(e,d,c.dataset)})},Fd=function(){ca(Y.galleryItemClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,
function(b){fa(a,function(c,d,e){if(!d.reviewId||!d.mediaId)throw Error("reviewId or mediaId was not found on the media gallery item: "+JSON.stringify(e));c.updateModalWithReview(d.reviewId,d.mediaId,d.mediaType)});return[2]})})})},Gd=function(){ca(Y.showMediaGalleryClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){fa(a,function(c){return c.showMediaGallery()});return[2]})})})},Hd=function(){ca(Y.reloadMediaPopover,"click",function(a){return g.__awaiter(void 0,
void 0,void 0,function(){return g.__generator(this,function(b){fa(a,function(c,d,e){if("true"===e.showgalleryinmodal&&!d.asin)throw Error("asin was not found on the toastbar : "+JSON.stringify(e));if(!("true"===e.showgalleryinmodal||d.reviewId&&d.mediaId&&d.asin))throw Error("reviewId/mediaId/asin was not found on the toastbar : "+JSON.stringify(e));c.loadModal({asin:d.asin,mediaId:d.mediaId,reviewId:d.reviewId,mediaType:d.mediaType,showGalleryInModal:"true"==e.showgalleryinmodal?!0:!1,popoverDetails:{popoverName:e.popovername}})});
return[2]})})})},Id=function(){ca(Y.thumbnailClickHandler,"click",function(a){fa(a,function(b,c,d){if(!c.mediaId)throw Error("mediaId was not found while clicking on media thumbnail: "+d);b.updateMediaInModal(c.mediaId)})})},Jd=function(){ca(Y.rightClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){fa(a,function(c){return c.handleModalMediaProgressionClick(X.RIGHT)});return[2]})})});ca(Y.leftClickHandler,"click",function(a){return g.__awaiter(void 0,
void 0,void 0,function(){return g.__generator(this,function(b){fa(a,function(c){return c.handleModalMediaProgressionClick(X.LEFT)});return[2]})})})},Kd=function(){ca(Y.expandTextClickHandler,"click",function(a){fa(a,function(b){return b.handleExpanderClick(za.EXPAND)})});ca(Y.hideTextClickHandler,"click",function(a){fa(a,function(b){return b.handleExpanderClick(za.HIDE)})})},Ld=function(){ca(Y.openReportConfirmationDialogClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,
function(b){fa(a,function(c){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(d){c.openReportAbuseDialog(a.currentTarget);return[2]})})});return[2]})})});ca(Y.confirmReportAbuseClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){fa(a,function(c){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(d){c.handleReportAbuseClick();return[2]})})});return[2]})})})},
Md=function(){ca(Y.helpfulVoteClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){fa(a,function(c){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(d){c.handleHelpulVoteClick();return[2]})})});return[2]})})})},Nd=function(){ca(Y.closeMediaPopover,"click",function(a){fa(a,function(b){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(c){b.closeModal();return[2]})})})})},
Od=function(){ca(Y.noopHandler,"click",function(a){a.stopBubble()})},Pd=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a,b;return g.__generator(this,function(c){switch(c.label){case 0:return[4,Qb()];case 1:a=c.sent();switch(a){case ja.DESKTOP:Fd();Gd();Hd();Id();Jd();Kd();Ld();Md();Od();Nd();bc.registerCloseToastBarClickHandler();break;case ja.MWEB:b=new Ed,b.registerMediaPopoverClickHandlers()}return[2]}})})};Ab._operationNames=[];Ab.card=function(){return g.__awaiter(void 0,void 0,
void 0,function(){var a,b,c,d,e,f,h;return g.__generator(this,function(k){switch(k.label){case 0:G.setPrefix("cr-media-carousel"),a=!1,k.label=1;case 1:return k.trys.push([1,3,,4]),[4,Nc()];case 2:return(a=k.sent())&&G.logCounter("client.earlyMashInitialization.success",1),[3,4];case 3:return b=k.sent(),G.logError("client.earlyMashInitialization.error",b),a=!1,[3,4];case 4:return[4,Ad.getThumbnailClickHandler()];case 5:return c=k.sent(),d=new Bd(c),d.registerThumbnailClickHandlers(),a?[3,7]:[4,Pd()];
case 6:k.sent(),k.label=7;case 7:e=ua.setup(["getTreatmentNoTrigger"]),k.label=8;case 8:return k.trys.push([8,13,,14]),[4,e.getTreatmentNoTrigger({weblabID:"COFEE_DD_MEDIA_CARDS_MIGRATION_SHARED_LIBRARY_1247512"})];case 9:return f=k.sent(),"T1"!==f?[3,12]:[4,Fc()];case 10:return k.sent(),[4,Gc()];case 11:k.sent(),k.label=12;case 12:return[3,14];case 13:return h=k.sent(),G.logError("client.getWeblabTreatmentError",h),[3,14];case 14:return G.logCounter("client.loaded",1),[2]}})})}});
